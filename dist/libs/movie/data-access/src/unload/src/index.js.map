{"version":3,"sources":["../../../../../../../libs/movie/data-access/node_modules/unload/src/index.js"],"sourcesContent":["import isNode from 'detect-node';\nimport BrowserMethod from './browser.js';\nimport NodeMethod from './node.js';\n\nconst USE_METHOD = isNode ? NodeMethod : BrowserMethod;\nconst LISTENERS = new Set();\n\nlet startedListening = false;\nfunction startListening() {\n    if (startedListening) return;\n    startedListening = true;\n    USE_METHOD.add(runAll);\n}\n\nexport function add(fn) {\n    startListening();\n    if (typeof fn !== 'function')\n        throw new Error('Listener is no function');\n    LISTENERS.add(fn);\n\n    const addReturn = {\n        remove: () => LISTENERS.delete(fn),\n        run: () => {\n            LISTENERS.delete(fn);\n            return fn();\n        }\n    };\n    return addReturn;\n}\n\nexport function runAll() {\n    const promises = [];\n    LISTENERS.forEach(function (fn) {\n        promises.push(fn());\n        LISTENERS.delete(fn);\n    });\n    return Promise.all(promises);\n}\n\nexport function removeAll() {\n    LISTENERS.clear();\n}\n\nexport function getSize() {\n    return LISTENERS.size;\n}\n\nexport default {\n    add,\n    runAll,\n    removeAll,\n    getSize\n};\n"],"names":["add","runAll","removeAll","getSize","USE_METHOD","isNode","NodeMethod","BrowserMethod","LISTENERS","Set","startedListening","startListening","fn","Error","addReturn","remove","delete","run","promises","forEach","push","Promise","all","clear","size"],"mappings":";QAcgBA,GAAG,GAAHA,GAAG;QAgBHC,MAAM,GAANA,MAAM;QASNC,SAAS,GAATA,SAAS;QAITC,OAAO,GAAPA,OAAO;;AA3CJ,GAAa,CAAb,WAAa;AACN,GAAc,CAAd,UAAc;AACjB,GAAW,CAAX,OAAW;AAElC,KAAK,CAACC,UAAU,GAAGC,WAAM,WAAGC,OAAU,WAAGC,UAAa;AACtD,KAAK,CAACC,SAAS,GAAG,GAAG,CAACC,GAAG;AAEzB,GAAG,CAACC,gBAAgB,GAAG,KAAK;SACnBC,cAAc,GAAG,CAAC;IACvB,EAAE,EAAED,gBAAgB,EAAE,MAAM;IAC5BA,gBAAgB,GAAG,IAAI;IACvBN,UAAU,CAACJ,GAAG,CAACC,MAAM;AACzB,CAAC;SAEeD,GAAG,CAACY,EAAE,EAAE,CAAC;IACrBD,cAAc;IACd,EAAE,EAAE,MAAM,CAACC,EAAE,KAAK,CAAU,WACxB,KAAK,CAAC,GAAG,CAACC,KAAK,CAAC,CAAyB;IAC7CL,SAAS,CAACR,GAAG,CAACY,EAAE;IAEhB,KAAK,CAACE,SAAS,GAAG,CAAC;QACfC,MAAM,MAAQP,SAAS,CAACQ,MAAM,CAACJ,EAAE;;QACjCK,GAAG,MAAQ,CAAC;YACRT,SAAS,CAACQ,MAAM,CAACJ,EAAE;YACnB,MAAM,CAACA,EAAE;QACb,CAAC;IACL,CAAC;IACD,MAAM,CAACE,SAAS;AACpB,CAAC;SAEeb,MAAM,GAAG,CAAC;IACtB,KAAK,CAACiB,QAAQ,GAAG,CAAC,CAAC;IACnBV,SAAS,CAACW,OAAO,CAAC,QAAQ,CAAEP,EAAE,EAAE,CAAC;QAC7BM,QAAQ,CAACE,IAAI,CAACR,EAAE;QAChBJ,SAAS,CAACQ,MAAM,CAACJ,EAAE;IACvB,CAAC;IACD,MAAM,CAACS,OAAO,CAACC,GAAG,CAACJ,QAAQ;AAC/B,CAAC;SAEehB,SAAS,GAAG,CAAC;IACzBM,SAAS,CAACe,KAAK;AACnB,CAAC;SAEepB,OAAO,GAAG,CAAC;IACvB,MAAM,CAACK,SAAS,CAACgB,IAAI;AACzB,CAAC;eAEc,CAAC;IACZxB,GAAG;IACHC,MAAM;IACNC,SAAS;IACTC,OAAO;AACX,CAAC"}