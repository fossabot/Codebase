{"version":3,"sources":["../../../../../../../libs/movie/data-access/node_modules/websocket/lib/WebSocketConnection.js"],"sourcesContent":["/************************************************************************\n *  Copyright 2010-2015 Brian McKelvey.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n ***********************************************************************/\n\nvar util = require('util');\nvar utils = require('./utils');\nvar EventEmitter = require('events').EventEmitter;\nvar WebSocketFrame = require('./WebSocketFrame');\nvar BufferList = require('../vendor/FastBufferList');\nvar isValidUTF8 = require('utf-8-validate');\nvar bufferAllocUnsafe = utils.bufferAllocUnsafe;\nvar bufferFromString = utils.bufferFromString;\n\n// Connected, fully-open, ready to send and receive frames\nconst STATE_OPEN = 'open';\n// Received a close frame from the remote peer\nconst STATE_PEER_REQUESTED_CLOSE = 'peer_requested_close';\n// Sent close frame to remote peer.  No further data can be sent.\nconst STATE_ENDING = 'ending';\n// Connection is fully closed.  No further data can be sent or received.\nconst STATE_CLOSED = 'closed';\n\nvar setImmediateImpl = ('setImmediate' in global) ?\n                            global.setImmediate.bind(global) :\n                            process.nextTick.bind(process);\n\nvar idCounter = 0;\n\nfunction WebSocketConnection(socket, extensions, protocol, maskOutgoingPackets, config) {\n    this._debug = utils.BufferingLogger('websocket:connection', ++idCounter);\n    this._debug('constructor');\n    \n    if (this._debug.enabled) {\n        instrumentSocketForDebugging(this, socket);\n    }\n    \n    // Superclass Constructor\n    EventEmitter.call(this);\n\n    this._pingListenerCount = 0;\n    this.on('newListener', function(ev) {\n        if (ev === 'ping'){\n            this._pingListenerCount++;\n        }\n      }).on('removeListener', function(ev) {\n        if (ev === 'ping') {\n            this._pingListenerCount--;\n        }\n    });\n\n    this.config = config;\n    this.socket = socket;\n    this.protocol = protocol;\n    this.extensions = extensions;\n    this.remoteAddress = socket.remoteAddress;\n    this.closeReasonCode = -1;\n    this.closeDescription = null;\n    this.closeEventEmitted = false;\n\n    // We have to mask outgoing packets if we're acting as a WebSocket client.\n    this.maskOutgoingPackets = maskOutgoingPackets;\n\n    // We re-use the same buffers for the mask and frame header for all frames\n    // received on each connection to avoid a small memory allocation for each\n    // frame.\n    this.maskBytes = bufferAllocUnsafe(4);\n    this.frameHeader = bufferAllocUnsafe(10);\n\n    // the BufferList will handle the data streaming in\n    this.bufferList = new BufferList();\n\n    // Prepare for receiving first frame\n    this.currentFrame = new WebSocketFrame(this.maskBytes, this.frameHeader, this.config);\n    this.fragmentationSize = 0; // data received so far...\n    this.frameQueue = [];\n    \n    // Various bits of connection state\n    this.connected = true;\n    this.state = STATE_OPEN;\n    this.waitingForCloseResponse = false;\n    // Received TCP FIN, socket's readable stream is finished.\n    this.receivedEnd = false;\n\n    this.closeTimeout = this.config.closeTimeout;\n    this.assembleFragments = this.config.assembleFragments;\n    this.maxReceivedMessageSize = this.config.maxReceivedMessageSize;\n\n    this.outputBufferFull = false;\n    this.inputPaused = false;\n    this.receivedDataHandler = this.processReceivedData.bind(this);\n    this._closeTimerHandler = this.handleCloseTimer.bind(this);\n\n    // Disable nagle algorithm?\n    this.socket.setNoDelay(this.config.disableNagleAlgorithm);\n\n    // Make sure there is no socket inactivity timeout\n    this.socket.setTimeout(0);\n\n    if (this.config.keepalive && !this.config.useNativeKeepalive) {\n        if (typeof(this.config.keepaliveInterval) !== 'number') {\n            throw new Error('keepaliveInterval must be specified and numeric ' +\n                            'if keepalive is true.');\n        }\n        this._keepaliveTimerHandler = this.handleKeepaliveTimer.bind(this);\n        this.setKeepaliveTimer();\n\n        if (this.config.dropConnectionOnKeepaliveTimeout) {\n            if (typeof(this.config.keepaliveGracePeriod) !== 'number') {\n                throw new Error('keepaliveGracePeriod  must be specified and ' +\n                                'numeric if dropConnectionOnKeepaliveTimeout ' +\n                                'is true.');\n            }\n            this._gracePeriodTimerHandler = this.handleGracePeriodTimer.bind(this);\n        }\n    }\n    else if (this.config.keepalive && this.config.useNativeKeepalive) {\n        if (!('setKeepAlive' in this.socket)) {\n            throw new Error('Unable to use native keepalive: unsupported by ' +\n                            'this version of Node.');\n        }\n        this.socket.setKeepAlive(true, this.config.keepaliveInterval);\n    }\n    \n    // The HTTP Client seems to subscribe to socket error events\n    // and re-dispatch them in such a way that doesn't make sense\n    // for users of our client, so we want to make sure nobody\n    // else is listening for error events on the socket besides us.\n    this.socket.removeAllListeners('error');\n}\n\nWebSocketConnection.CLOSE_REASON_NORMAL = 1000;\nWebSocketConnection.CLOSE_REASON_GOING_AWAY = 1001;\nWebSocketConnection.CLOSE_REASON_PROTOCOL_ERROR = 1002;\nWebSocketConnection.CLOSE_REASON_UNPROCESSABLE_INPUT = 1003;\nWebSocketConnection.CLOSE_REASON_RESERVED = 1004; // Reserved value.  Undefined meaning.\nWebSocketConnection.CLOSE_REASON_NOT_PROVIDED = 1005; // Not to be used on the wire\nWebSocketConnection.CLOSE_REASON_ABNORMAL = 1006; // Not to be used on the wire\nWebSocketConnection.CLOSE_REASON_INVALID_DATA = 1007;\nWebSocketConnection.CLOSE_REASON_POLICY_VIOLATION = 1008;\nWebSocketConnection.CLOSE_REASON_MESSAGE_TOO_BIG = 1009;\nWebSocketConnection.CLOSE_REASON_EXTENSION_REQUIRED = 1010;\nWebSocketConnection.CLOSE_REASON_INTERNAL_SERVER_ERROR = 1011;\nWebSocketConnection.CLOSE_REASON_TLS_HANDSHAKE_FAILED = 1015; // Not to be used on the wire\n\nWebSocketConnection.CLOSE_DESCRIPTIONS = {\n    1000: 'Normal connection closure',\n    1001: 'Remote peer is going away',\n    1002: 'Protocol error',\n    1003: 'Unprocessable input',\n    1004: 'Reserved',\n    1005: 'Reason not provided',\n    1006: 'Abnormal closure, no further detail available',\n    1007: 'Invalid data received',\n    1008: 'Policy violation',\n    1009: 'Message too big',\n    1010: 'Extension requested by client is required',\n    1011: 'Internal Server Error',\n    1015: 'TLS Handshake Failed'\n};\n\nfunction validateCloseReason(code) {\n    if (code < 1000) {\n        // Status codes in the range 0-999 are not used\n        return false;\n    }\n    if (code >= 1000 && code <= 2999) {\n        // Codes from 1000 - 2999 are reserved for use by the protocol.  Only\n        // a few codes are defined, all others are currently illegal.\n        return [1000, 1001, 1002, 1003, 1007, 1008, 1009, 1010, 1011, 1012, 1013, 1014, 1015].indexOf(code) !== -1;\n    }\n    if (code >= 3000 && code <= 3999) {\n        // Reserved for use by libraries, frameworks, and applications.\n        // Should be registered with IANA.  Interpretation of these codes is\n        // undefined by the WebSocket protocol.\n        return true;\n    }\n    if (code >= 4000 && code <= 4999) {\n        // Reserved for private use.  Interpretation of these codes is\n        // undefined by the WebSocket protocol.\n        return true;\n    }\n    if (code >= 5000) {\n        return false;\n    }\n}\n\nutil.inherits(WebSocketConnection, EventEmitter);\n\nWebSocketConnection.prototype._addSocketEventListeners = function() {\n    this.socket.on('error', this.handleSocketError.bind(this));\n    this.socket.on('end', this.handleSocketEnd.bind(this));\n    this.socket.on('close', this.handleSocketClose.bind(this));\n    this.socket.on('drain', this.handleSocketDrain.bind(this));\n    this.socket.on('pause', this.handleSocketPause.bind(this));\n    this.socket.on('resume', this.handleSocketResume.bind(this));\n    this.socket.on('data', this.handleSocketData.bind(this));\n};\n\n// set or reset the keepalive timer when data is received.\nWebSocketConnection.prototype.setKeepaliveTimer = function() {\n    this._debug('setKeepaliveTimer');\n    if (!this.config.keepalive  || this.config.useNativeKeepalive) { return; }\n    this.clearKeepaliveTimer();\n    this.clearGracePeriodTimer();\n    this._keepaliveTimeoutID = setTimeout(this._keepaliveTimerHandler, this.config.keepaliveInterval);\n};\n\nWebSocketConnection.prototype.clearKeepaliveTimer = function() {\n    if (this._keepaliveTimeoutID) {\n        clearTimeout(this._keepaliveTimeoutID);\n    }\n};\n\n// No data has been received within config.keepaliveTimeout ms.\nWebSocketConnection.prototype.handleKeepaliveTimer = function() {\n    this._debug('handleKeepaliveTimer');\n    this._keepaliveTimeoutID = null;\n    this.ping();\n\n    // If we are configured to drop connections if the client doesn't respond\n    // then set the grace period timer.\n    if (this.config.dropConnectionOnKeepaliveTimeout) {\n        this.setGracePeriodTimer();\n    }\n    else {\n        // Otherwise reset the keepalive timer to send the next ping.\n        this.setKeepaliveTimer();\n    }\n};\n\nWebSocketConnection.prototype.setGracePeriodTimer = function() {\n    this._debug('setGracePeriodTimer');\n    this.clearGracePeriodTimer();\n    this._gracePeriodTimeoutID = setTimeout(this._gracePeriodTimerHandler, this.config.keepaliveGracePeriod);\n};\n\nWebSocketConnection.prototype.clearGracePeriodTimer = function() {\n    if (this._gracePeriodTimeoutID) {\n        clearTimeout(this._gracePeriodTimeoutID);\n    }\n};\n\nWebSocketConnection.prototype.handleGracePeriodTimer = function() {\n    this._debug('handleGracePeriodTimer');\n    // If this is called, the client has not responded and is assumed dead.\n    this._gracePeriodTimeoutID = null;\n    this.drop(WebSocketConnection.CLOSE_REASON_ABNORMAL, 'Peer not responding.', true);\n};\n\nWebSocketConnection.prototype.handleSocketData = function(data) {\n    this._debug('handleSocketData');\n    // Reset the keepalive timer when receiving data of any kind.\n    this.setKeepaliveTimer();\n\n    // Add received data to our bufferList, which efficiently holds received\n    // data chunks in a linked list of Buffer objects.\n    this.bufferList.write(data);\n\n    this.processReceivedData();\n};\n\nWebSocketConnection.prototype.processReceivedData = function() {\n    this._debug('processReceivedData');\n    // If we're not connected, we should ignore any data remaining on the buffer.\n    if (!this.connected) { return; }\n\n    // Receiving/parsing is expected to be halted when paused.\n    if (this.inputPaused) { return; }\n\n    var frame = this.currentFrame;\n\n    // WebSocketFrame.prototype.addData returns true if all data necessary to\n    // parse the frame was available.  It returns false if we are waiting for\n    // more data to come in on the wire.\n    if (!frame.addData(this.bufferList)) { this._debug('-- insufficient data for frame'); return; }\n\n    var self = this;\n\n    // Handle possible parsing errors\n    if (frame.protocolError) {\n        // Something bad happened.. get rid of this client.\n        this._debug('-- protocol error');\n        process.nextTick(function() {\n            self.drop(WebSocketConnection.CLOSE_REASON_PROTOCOL_ERROR, frame.dropReason);\n        });\n        return;\n    }\n    else if (frame.frameTooLarge) {\n        this._debug('-- frame too large');\n        process.nextTick(function() {\n            self.drop(WebSocketConnection.CLOSE_REASON_MESSAGE_TOO_BIG, frame.dropReason);\n        });\n        return;\n    }\n\n    // For now since we don't support extensions, all RSV bits are illegal\n    if (frame.rsv1 || frame.rsv2 || frame.rsv3) {\n        this._debug('-- illegal rsv flag');\n        process.nextTick(function() {\n            self.drop(WebSocketConnection.CLOSE_REASON_PROTOCOL_ERROR,\n              'Unsupported usage of rsv bits without negotiated extension.');\n        });\n        return;\n    }\n\n    if (!this.assembleFragments) {\n        this._debug('-- emitting frame');\n        process.nextTick(function() { self.emit('frame', frame); });\n    }\n\n    process.nextTick(function() { self.processFrame(frame); });\n    \n    this.currentFrame = new WebSocketFrame(this.maskBytes, this.frameHeader, this.config);\n\n    // If there's data remaining, schedule additional processing, but yield\n    // for now so that other connections have a chance to have their data\n    // processed.  We use setImmediate here instead of process.nextTick to\n    // explicitly indicate that we wish for other I/O to be handled first.\n    if (this.bufferList.length > 0) {\n        setImmediateImpl(this.receivedDataHandler);\n    }\n};\n\nWebSocketConnection.prototype.handleSocketError = function(error) {\n    this._debug('handleSocketError: %j', error);\n    if (this.state === STATE_CLOSED) {\n\t\t// See https://github.com/theturtle32/WebSocket-Node/issues/288\n        this._debug('  --- Socket \\'error\\' after \\'close\\'');\n        return;\n    }\n    this.closeReasonCode = WebSocketConnection.CLOSE_REASON_ABNORMAL;\n    this.closeDescription = 'Socket Error: ' + error.syscall + ' ' + error.code;\n    this.connected = false;\n    this.state = STATE_CLOSED;\n    this.fragmentationSize = 0;\n    if (utils.eventEmitterListenerCount(this, 'error') > 0) {\n        this.emit('error', error);\n    }\n    this.socket.destroy();\n    this._debug.printOutput();\n};\n\nWebSocketConnection.prototype.handleSocketEnd = function() {\n    this._debug('handleSocketEnd: received socket end.  state = %s', this.state);\n    this.receivedEnd = true;\n    if (this.state === STATE_CLOSED) {\n        // When using the TLS module, sometimes the socket will emit 'end'\n        // after it emits 'close'.  I don't think that's correct behavior,\n        // but we should deal with it gracefully by ignoring it.\n        this._debug('  --- Socket \\'end\\' after \\'close\\'');\n        return;\n    }\n    if (this.state !== STATE_PEER_REQUESTED_CLOSE &&\n        this.state !== STATE_ENDING) {\n      this._debug('  --- UNEXPECTED socket end.');\n      this.socket.end();\n    }\n};\n\nWebSocketConnection.prototype.handleSocketClose = function(hadError) {\n    this._debug('handleSocketClose: received socket close');\n    this.socketHadError = hadError;\n    this.connected = false;\n    this.state = STATE_CLOSED;\n    // If closeReasonCode is still set to -1 at this point then we must\n    // not have received a close frame!!\n    if (this.closeReasonCode === -1) {\n        this.closeReasonCode = WebSocketConnection.CLOSE_REASON_ABNORMAL;\n        this.closeDescription = 'Connection dropped by remote peer.';\n    }\n    this.clearCloseTimer();\n    this.clearKeepaliveTimer();\n    this.clearGracePeriodTimer();\n    if (!this.closeEventEmitted) {\n        this.closeEventEmitted = true;\n        this._debug('-- Emitting WebSocketConnection close event');\n        this.emit('close', this.closeReasonCode, this.closeDescription);\n    }\n};\n\nWebSocketConnection.prototype.handleSocketDrain = function() {\n    this._debug('handleSocketDrain: socket drain event');\n    this.outputBufferFull = false;\n    this.emit('drain');\n};\n\nWebSocketConnection.prototype.handleSocketPause = function() {\n    this._debug('handleSocketPause: socket pause event');\n    this.inputPaused = true;\n    this.emit('pause');\n};\n\nWebSocketConnection.prototype.handleSocketResume = function() {\n    this._debug('handleSocketResume: socket resume event');\n    this.inputPaused = false;\n    this.emit('resume');\n    this.processReceivedData();\n};\n\nWebSocketConnection.prototype.pause = function() {\n    this._debug('pause: pause requested');\n    this.socket.pause();\n};\n\nWebSocketConnection.prototype.resume = function() {\n    this._debug('resume: resume requested');\n    this.socket.resume();\n};\n\nWebSocketConnection.prototype.close = function(reasonCode, description) {\n    if (this.connected) {\n        this._debug('close: Initating clean WebSocket close sequence.');\n        if ('number' !== typeof reasonCode) {\n            reasonCode = WebSocketConnection.CLOSE_REASON_NORMAL;\n        }\n        if (!validateCloseReason(reasonCode)) {\n            throw new Error('Close code ' + reasonCode + ' is not valid.');\n        }\n        if ('string' !== typeof description) {\n            description = WebSocketConnection.CLOSE_DESCRIPTIONS[reasonCode];\n        }\n        this.closeReasonCode = reasonCode;\n        this.closeDescription = description;\n        this.setCloseTimer();\n        this.sendCloseFrame(this.closeReasonCode, this.closeDescription);\n        this.state = STATE_ENDING;\n        this.connected = false;\n    }\n};\n\nWebSocketConnection.prototype.drop = function(reasonCode, description, skipCloseFrame) {\n    this._debug('drop');\n    if (typeof(reasonCode) !== 'number') {\n        reasonCode = WebSocketConnection.CLOSE_REASON_PROTOCOL_ERROR;\n    }\n\n    if (typeof(description) !== 'string') {\n        // If no description is provided, try to look one up based on the\n        // specified reasonCode.\n        description = WebSocketConnection.CLOSE_DESCRIPTIONS[reasonCode];\n    }\n\n    this._debug('Forcefully dropping connection. skipCloseFrame: %s, code: %d, description: %s',\n        skipCloseFrame, reasonCode, description\n    );\n\n    this.closeReasonCode = reasonCode;\n    this.closeDescription = description;\n    this.frameQueue = [];\n    this.fragmentationSize = 0;\n    if (!skipCloseFrame) {\n        this.sendCloseFrame(reasonCode, description);\n    }\n    this.connected = false;\n    this.state = STATE_CLOSED;\n    this.clearCloseTimer();\n    this.clearKeepaliveTimer();\n    this.clearGracePeriodTimer();\n\n    if (!this.closeEventEmitted) {\n        this.closeEventEmitted = true;\n        this._debug('Emitting WebSocketConnection close event');\n        this.emit('close', this.closeReasonCode, this.closeDescription);\n    }\n    \n    this._debug('Drop: destroying socket');\n    this.socket.destroy();\n};\n\nWebSocketConnection.prototype.setCloseTimer = function() {\n    this._debug('setCloseTimer');\n    this.clearCloseTimer();\n    this._debug('Setting close timer');\n    this.waitingForCloseResponse = true;\n    this.closeTimer = setTimeout(this._closeTimerHandler, this.closeTimeout);\n};\n\nWebSocketConnection.prototype.clearCloseTimer = function() {\n    this._debug('clearCloseTimer');\n    if (this.closeTimer) {\n        this._debug('Clearing close timer');\n        clearTimeout(this.closeTimer);\n        this.waitingForCloseResponse = false;\n        this.closeTimer = null;\n    }\n};\n\nWebSocketConnection.prototype.handleCloseTimer = function() {\n    this._debug('handleCloseTimer');\n    this.closeTimer = null;\n    if (this.waitingForCloseResponse) {\n        this._debug('Close response not received from client.  Forcing socket end.');\n        this.waitingForCloseResponse = false;\n        this.state = STATE_CLOSED;\n        this.socket.end();\n    }\n};\n\nWebSocketConnection.prototype.processFrame = function(frame) {\n    this._debug('processFrame');\n    this._debug(' -- frame: %s', frame);\n    \n    // Any non-control opcode besides 0x00 (continuation) received in the\n    // middle of a fragmented message is illegal.\n    if (this.frameQueue.length !== 0 && (frame.opcode > 0x00 && frame.opcode < 0x08)) {\n        this.drop(WebSocketConnection.CLOSE_REASON_PROTOCOL_ERROR,\n          'Illegal frame opcode 0x' + frame.opcode.toString(16) + ' ' +\n          'received in middle of fragmented message.');\n        return;\n    }\n\n    switch(frame.opcode) {\n        case 0x02: // WebSocketFrame.BINARY_FRAME\n            this._debug('-- Binary Frame');\n            if (this.assembleFragments) {\n                if (frame.fin) {\n                    // Complete single-frame message received\n                    this._debug('---- Emitting \\'message\\' event');\n                    this.emit('message', {\n                        type: 'binary',\n                        binaryData: frame.binaryPayload\n                    });\n                }\n                else {\n                    // beginning of a fragmented message\n                    this.frameQueue.push(frame);\n                    this.fragmentationSize = frame.length;\n                }\n            }\n            break;\n        case 0x01: // WebSocketFrame.TEXT_FRAME\n            this._debug('-- Text Frame');\n            if (this.assembleFragments) {\n                if (frame.fin) {\n                    if (!isValidUTF8(frame.binaryPayload)) {\n                        this.drop(WebSocketConnection.CLOSE_REASON_INVALID_DATA,\n                          'Invalid UTF-8 Data Received');\n                        return;\n                    }\n                    // Complete single-frame message received\n                    this._debug('---- Emitting \\'message\\' event');\n                    this.emit('message', {\n                        type: 'utf8',\n                        utf8Data: frame.binaryPayload.toString('utf8')\n                    });\n                }\n                else {\n                    // beginning of a fragmented message\n                    this.frameQueue.push(frame);\n                    this.fragmentationSize = frame.length;\n                }\n            }\n            break;\n        case 0x00: // WebSocketFrame.CONTINUATION\n            this._debug('-- Continuation Frame');\n            if (this.assembleFragments) {\n                if (this.frameQueue.length === 0) {\n                    this.drop(WebSocketConnection.CLOSE_REASON_PROTOCOL_ERROR,\n                      'Unexpected Continuation Frame');\n                    return;\n                }\n\n                this.fragmentationSize += frame.length;\n\n                if (this.fragmentationSize > this.maxReceivedMessageSize) {\n                    this.drop(WebSocketConnection.CLOSE_REASON_MESSAGE_TOO_BIG,\n                      'Maximum message size exceeded.');\n                    return;\n                }\n\n                this.frameQueue.push(frame);\n\n                if (frame.fin) {\n                    // end of fragmented message, so we process the whole\n                    // message now.  We also have to decode the utf-8 data\n                    // for text frames after combining all the fragments.\n                    var bytesCopied = 0;\n                    var binaryPayload = bufferAllocUnsafe(this.fragmentationSize);\n                    var opcode = this.frameQueue[0].opcode;\n                    this.frameQueue.forEach(function (currentFrame) {\n                        currentFrame.binaryPayload.copy(binaryPayload, bytesCopied);\n                        bytesCopied += currentFrame.binaryPayload.length;\n                    });\n                    this.frameQueue = [];\n                    this.fragmentationSize = 0;\n\n                    switch (opcode) {\n                        case 0x02: // WebSocketOpcode.BINARY_FRAME\n                            this.emit('message', {\n                                type: 'binary',\n                                binaryData: binaryPayload\n                            });\n                            break;\n                        case 0x01: // WebSocketOpcode.TEXT_FRAME\n                            if (!isValidUTF8(binaryPayload)) {\n                                this.drop(WebSocketConnection.CLOSE_REASON_INVALID_DATA,\n                                  'Invalid UTF-8 Data Received');\n                                return;\n                            }\n                            this.emit('message', {\n                                type: 'utf8',\n                                utf8Data: binaryPayload.toString('utf8')\n                            });\n                            break;\n                        default:\n                            this.drop(WebSocketConnection.CLOSE_REASON_PROTOCOL_ERROR,\n                              'Unexpected first opcode in fragmentation sequence: 0x' + opcode.toString(16));\n                            return;\n                    }\n                }\n            }\n            break;\n        case 0x09: // WebSocketFrame.PING\n            this._debug('-- Ping Frame');\n\n            if (this._pingListenerCount > 0) {\n                // logic to emit the ping frame: this is only done when a listener is known to exist\n                // Expose a function allowing the user to override the default ping() behavior\n                var cancelled = false;\n                var cancel = function() { \n                  cancelled = true; \n                };\n                this.emit('ping', cancel, frame.binaryPayload);\n\n                // Only send a pong if the client did not indicate that he would like to cancel\n                if (!cancelled) {\n                    this.pong(frame.binaryPayload);\n                }\n            }\n            else {\n                this.pong(frame.binaryPayload);\n            }\n\n            break;\n        case 0x0A: // WebSocketFrame.PONG\n            this._debug('-- Pong Frame');\n            this.emit('pong', frame.binaryPayload);\n            break;\n        case 0x08: // WebSocketFrame.CONNECTION_CLOSE\n            this._debug('-- Close Frame');\n            if (this.waitingForCloseResponse) {\n                // Got response to our request to close the connection.\n                // Close is complete, so we just hang up.\n                this._debug('---- Got close response from peer.  Completing closing handshake.');\n                this.clearCloseTimer();\n                this.waitingForCloseResponse = false;\n                this.state = STATE_CLOSED;\n                this.socket.end();\n                return;\n            }\n            \n            this._debug('---- Closing handshake initiated by peer.');\n            // Got request from other party to close connection.\n            // Send back acknowledgement and then hang up.\n            this.state = STATE_PEER_REQUESTED_CLOSE;\n            var respondCloseReasonCode;\n\n            // Make sure the close reason provided is legal according to\n            // the protocol spec.  Providing no close status is legal.\n            // WebSocketFrame sets closeStatus to -1 by default, so if it\n            // is still -1, then no status was provided.\n            if (frame.invalidCloseFrameLength) {\n                this.closeReasonCode = 1005; // 1005 = No reason provided.\n                respondCloseReasonCode = WebSocketConnection.CLOSE_REASON_PROTOCOL_ERROR;\n            }\n            else if (frame.closeStatus === -1 || validateCloseReason(frame.closeStatus)) {\n                this.closeReasonCode = frame.closeStatus;\n                respondCloseReasonCode = WebSocketConnection.CLOSE_REASON_NORMAL;\n            }\n            else {\n                this.closeReasonCode = frame.closeStatus;\n                respondCloseReasonCode = WebSocketConnection.CLOSE_REASON_PROTOCOL_ERROR;\n            }\n            \n            // If there is a textual description in the close frame, extract it.\n            if (frame.binaryPayload.length > 1) {\n                if (!isValidUTF8(frame.binaryPayload)) {\n                    this.drop(WebSocketConnection.CLOSE_REASON_INVALID_DATA,\n                      'Invalid UTF-8 Data Received');\n                    return;\n                }\n                this.closeDescription = frame.binaryPayload.toString('utf8');\n            }\n            else {\n                this.closeDescription = WebSocketConnection.CLOSE_DESCRIPTIONS[this.closeReasonCode];\n            }\n            this._debug(\n                '------ Remote peer %s - code: %d - %s - close frame payload length: %d',\n                this.remoteAddress, this.closeReasonCode,\n                this.closeDescription, frame.length\n            );\n            this._debug('------ responding to remote peer\\'s close request.');\n            this.sendCloseFrame(respondCloseReasonCode, null);\n            this.connected = false;\n            break;\n        default:\n            this._debug('-- Unrecognized Opcode %d', frame.opcode);\n            this.drop(WebSocketConnection.CLOSE_REASON_PROTOCOL_ERROR,\n              'Unrecognized Opcode: 0x' + frame.opcode.toString(16));\n            break;\n    }\n};\n\nWebSocketConnection.prototype.send = function(data, cb) {\n    this._debug('send');\n    if (Buffer.isBuffer(data)) {\n        this.sendBytes(data, cb);\n    }\n    else if (typeof(data['toString']) === 'function') {\n        this.sendUTF(data, cb);\n    }\n    else {\n        throw new Error('Data provided must either be a Node Buffer or implement toString()');\n    }\n};\n\nWebSocketConnection.prototype.sendUTF = function(data, cb) {\n    data = bufferFromString(data.toString(), 'utf8');\n    this._debug('sendUTF: %d bytes', data.length);\n    var frame = new WebSocketFrame(this.maskBytes, this.frameHeader, this.config);\n    frame.opcode = 0x01; // WebSocketOpcode.TEXT_FRAME\n    frame.binaryPayload = data;\n    this.fragmentAndSend(frame, cb);\n};\n\nWebSocketConnection.prototype.sendBytes = function(data, cb) {\n    this._debug('sendBytes');\n    if (!Buffer.isBuffer(data)) {\n        throw new Error('You must pass a Node Buffer object to WebSocketConnection.prototype.sendBytes()');\n    }\n    var frame = new WebSocketFrame(this.maskBytes, this.frameHeader, this.config);\n    frame.opcode = 0x02; // WebSocketOpcode.BINARY_FRAME\n    frame.binaryPayload = data;\n    this.fragmentAndSend(frame, cb);\n};\n\nWebSocketConnection.prototype.ping = function(data) {\n    this._debug('ping');\n    var frame = new WebSocketFrame(this.maskBytes, this.frameHeader, this.config);\n    frame.opcode = 0x09; // WebSocketOpcode.PING\n    frame.fin = true;\n    if (data) {\n        if (!Buffer.isBuffer(data)) {\n            data = bufferFromString(data.toString(), 'utf8');\n        }\n        if (data.length > 125) {\n            this._debug('WebSocket: Data for ping is longer than 125 bytes.  Truncating.');\n            data = data.slice(0,124);\n        }\n        frame.binaryPayload = data;\n    }\n    this.sendFrame(frame);\n};\n\n// Pong frames have to echo back the contents of the data portion of the\n// ping frame exactly, byte for byte.\nWebSocketConnection.prototype.pong = function(binaryPayload) {\n    this._debug('pong');\n    var frame = new WebSocketFrame(this.maskBytes, this.frameHeader, this.config);\n    frame.opcode = 0x0A; // WebSocketOpcode.PONG\n    if (Buffer.isBuffer(binaryPayload) && binaryPayload.length > 125) {\n        this._debug('WebSocket: Data for pong is longer than 125 bytes.  Truncating.');\n        binaryPayload = binaryPayload.slice(0,124);\n    }\n    frame.binaryPayload = binaryPayload;\n    frame.fin = true;\n    this.sendFrame(frame);\n};\n\nWebSocketConnection.prototype.fragmentAndSend = function(frame, cb) {\n    this._debug('fragmentAndSend');\n    if (frame.opcode > 0x07) {\n        throw new Error('You cannot fragment control frames.');\n    }\n\n    var threshold = this.config.fragmentationThreshold;\n    var length = frame.binaryPayload.length;\n\n    // Send immediately if fragmentation is disabled or the message is not\n    // larger than the fragmentation threshold.\n    if (!this.config.fragmentOutgoingMessages || (frame.binaryPayload && length <= threshold)) {\n        frame.fin = true;\n        this.sendFrame(frame, cb);\n        return;\n    }\n    \n    var numFragments = Math.ceil(length / threshold);\n    var sentFragments = 0;\n    var sentCallback = function fragmentSentCallback(err) {\n        if (err) {\n            if (typeof cb === 'function') {\n                // pass only the first error\n                cb(err);\n                cb = null;\n            }\n            return;\n        }\n        ++sentFragments;\n        if ((sentFragments === numFragments) && (typeof cb === 'function')) {\n            cb();\n        }\n    };\n    for (var i=1; i <= numFragments; i++) {\n        var currentFrame = new WebSocketFrame(this.maskBytes, this.frameHeader, this.config);\n        \n        // continuation opcode except for first frame.\n        currentFrame.opcode = (i === 1) ? frame.opcode : 0x00;\n        \n        // fin set on last frame only\n        currentFrame.fin = (i === numFragments);\n        \n        // length is likely to be shorter on the last fragment\n        var currentLength = (i === numFragments) ? length - (threshold * (i-1)) : threshold;\n        var sliceStart = threshold * (i-1);\n        \n        // Slice the right portion of the original payload\n        currentFrame.binaryPayload = frame.binaryPayload.slice(sliceStart, sliceStart + currentLength);\n        \n        this.sendFrame(currentFrame, sentCallback);\n    }\n};\n\nWebSocketConnection.prototype.sendCloseFrame = function(reasonCode, description, cb) {\n    if (typeof(reasonCode) !== 'number') {\n        reasonCode = WebSocketConnection.CLOSE_REASON_NORMAL;\n    }\n    \n    this._debug('sendCloseFrame state: %s, reasonCode: %d, description: %s', this.state, reasonCode, description);\n    \n    if (this.state !== STATE_OPEN && this.state !== STATE_PEER_REQUESTED_CLOSE) { return; }\n    \n    var frame = new WebSocketFrame(this.maskBytes, this.frameHeader, this.config);\n    frame.fin = true;\n    frame.opcode = 0x08; // WebSocketOpcode.CONNECTION_CLOSE\n    frame.closeStatus = reasonCode;\n    if (typeof(description) === 'string') {\n        frame.binaryPayload = bufferFromString(description, 'utf8');\n    }\n    \n    this.sendFrame(frame, cb);\n    this.socket.end();\n};\n\nWebSocketConnection.prototype.sendFrame = function(frame, cb) {\n    this._debug('sendFrame');\n    frame.mask = this.maskOutgoingPackets;\n    var flushed = this.socket.write(frame.toBuffer(), cb);\n    this.outputBufferFull = !flushed;\n    return flushed;\n};\n\nmodule.exports = WebSocketConnection;\n\n\n\nfunction instrumentSocketForDebugging(connection, socket) {\n    /* jshint loopfunc: true */\n    if (!connection._debug.enabled) { return; }\n    \n    var originalSocketEmit = socket.emit;\n    socket.emit = function(event) {\n        connection._debug('||| Socket Event  \\'%s\\'', event);\n        originalSocketEmit.apply(this, arguments);\n    };\n    \n    for (var key in socket) {\n        if ('function' !== typeof(socket[key])) { continue; }\n        if (['emit'].indexOf(key) !== -1) { continue; }\n        (function(key) {\n            var original = socket[key];\n            if (key === 'on') {\n                socket[key] = function proxyMethod__EventEmitter__On() {\n                    connection._debug('||| Socket method called:  %s (%s)', key, arguments[0]);\n                    return original.apply(this, arguments);\n                };\n                return;\n            }\n            socket[key] = function proxyMethod() {\n                connection._debug('||| Socket method called:  %s', key);\n                return original.apply(this, arguments);\n            };\n        })(key);\n    }\n}\n"],"names":["util","require","utils","EventEmitter","WebSocketFrame","BufferList","isValidUTF8","bufferAllocUnsafe","bufferFromString","STATE_OPEN","STATE_PEER_REQUESTED_CLOSE","STATE_ENDING","STATE_CLOSED","setImmediateImpl","global","setImmediate","bind","process","nextTick","idCounter","WebSocketConnection","socket","extensions","protocol","maskOutgoingPackets","config","_debug","BufferingLogger","enabled","instrumentSocketForDebugging","call","_pingListenerCount","on","ev","remoteAddress","closeReasonCode","closeDescription","closeEventEmitted","maskBytes","frameHeader","bufferList","currentFrame","fragmentationSize","frameQueue","connected","state","waitingForCloseResponse","receivedEnd","closeTimeout","assembleFragments","maxReceivedMessageSize","outputBufferFull","inputPaused","receivedDataHandler","processReceivedData","_closeTimerHandler","handleCloseTimer","setNoDelay","disableNagleAlgorithm","setTimeout","keepalive","useNativeKeepalive","keepaliveInterval","Error","_keepaliveTimerHandler","handleKeepaliveTimer","setKeepaliveTimer","dropConnectionOnKeepaliveTimeout","keepaliveGracePeriod","_gracePeriodTimerHandler","handleGracePeriodTimer","setKeepAlive","removeAllListeners","CLOSE_REASON_NORMAL","CLOSE_REASON_GOING_AWAY","CLOSE_REASON_PROTOCOL_ERROR","CLOSE_REASON_UNPROCESSABLE_INPUT","CLOSE_REASON_RESERVED","CLOSE_REASON_NOT_PROVIDED","CLOSE_REASON_ABNORMAL","CLOSE_REASON_INVALID_DATA","CLOSE_REASON_POLICY_VIOLATION","CLOSE_REASON_MESSAGE_TOO_BIG","CLOSE_REASON_EXTENSION_REQUIRED","CLOSE_REASON_INTERNAL_SERVER_ERROR","CLOSE_REASON_TLS_HANDSHAKE_FAILED","CLOSE_DESCRIPTIONS","validateCloseReason","code","indexOf","inherits","prototype","_addSocketEventListeners","handleSocketError","handleSocketEnd","handleSocketClose","handleSocketDrain","handleSocketPause","handleSocketResume","handleSocketData","clearKeepaliveTimer","clearGracePeriodTimer","_keepaliveTimeoutID","clearTimeout","ping","setGracePeriodTimer","_gracePeriodTimeoutID","drop","data","write","frame","addData","self","protocolError","dropReason","frameTooLarge","rsv1","rsv2","rsv3","emit","processFrame","length","error","syscall","eventEmitterListenerCount","destroy","printOutput","end","hadError","socketHadError","clearCloseTimer","pause","resume","close","reasonCode","description","setCloseTimer","sendCloseFrame","skipCloseFrame","closeTimer","opcode","toString","fin","type","binaryData","binaryPayload","push","utf8Data","bytesCopied","forEach","copy","cancelled","cancel","pong","respondCloseReasonCode","invalidCloseFrameLength","closeStatus","send","cb","Buffer","isBuffer","sendBytes","sendUTF","fragmentAndSend","slice","sendFrame","threshold","fragmentationThreshold","fragmentOutgoingMessages","numFragments","Math","ceil","sentFragments","sentCallback","fragmentSentCallback","err","i","currentLength","sliceStart","mask","flushed","toBuffer","module","exports","connection","originalSocketEmit","event","apply","arguments","key","original","proxyMethod__EventEmitter__On","proxyMethod"],"mappings":"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"}