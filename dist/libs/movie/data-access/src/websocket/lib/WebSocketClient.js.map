{"version":3,"sources":["../../../../../../../libs/movie/data-access/node_modules/websocket/lib/WebSocketClient.js"],"sourcesContent":["/************************************************************************\n *  Copyright 2010-2015 Brian McKelvey.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n ***********************************************************************/\n\nvar utils = require('./utils');\nvar extend = utils.extend;\nvar util = require('util');\nvar EventEmitter = require('events').EventEmitter;\nvar http = require('http');\nvar https = require('https');\nvar url = require('url');\nvar crypto = require('crypto');\nvar WebSocketConnection = require('./WebSocketConnection');\nvar bufferAllocUnsafe = utils.bufferAllocUnsafe;\n\nvar protocolSeparators = [\n    '(', ')', '<', '>', '@',\n    ',', ';', ':', '\\\\', '\\\"',\n    '/', '[', ']', '?', '=',\n    '{', '}', ' ', String.fromCharCode(9)\n];\n\nvar excludedTlsOptions = ['hostname','port','method','path','headers'];\n\nfunction WebSocketClient(config) {\n    // Superclass Constructor\n    EventEmitter.call(this);\n\n    // TODO: Implement extensions\n\n    this.config = {\n        // 1MiB max frame size.\n        maxReceivedFrameSize: 0x100000,\n\n        // 8MiB max message size, only applicable if\n        // assembleFragments is true\n        maxReceivedMessageSize: 0x800000,\n\n        // Outgoing messages larger than fragmentationThreshold will be\n        // split into multiple fragments.\n        fragmentOutgoingMessages: true,\n\n        // Outgoing frames are fragmented if they exceed this threshold.\n        // Default is 16KiB\n        fragmentationThreshold: 0x4000,\n\n        // Which version of the protocol to use for this session.  This\n        // option will be removed once the protocol is finalized by the IETF\n        // It is only available to ease the transition through the\n        // intermediate draft protocol versions.\n        // At present, it only affects the name of the Origin header.\n        webSocketVersion: 13,\n\n        // If true, fragmented messages will be automatically assembled\n        // and the full message will be emitted via a 'message' event.\n        // If false, each frame will be emitted via a 'frame' event and\n        // the application will be responsible for aggregating multiple\n        // fragmented frames.  Single-frame messages will emit a 'message'\n        // event in addition to the 'frame' event.\n        // Most users will want to leave this set to 'true'\n        assembleFragments: true,\n\n        // The Nagle Algorithm makes more efficient use of network resources\n        // by introducing a small delay before sending small packets so that\n        // multiple messages can be batched together before going onto the\n        // wire.  This however comes at the cost of latency, so the default\n        // is to disable it.  If you don't need low latency and are streaming\n        // lots of small messages, you can change this to 'false'\n        disableNagleAlgorithm: true,\n\n        // The number of milliseconds to wait after sending a close frame\n        // for an acknowledgement to come back before giving up and just\n        // closing the socket.\n        closeTimeout: 5000,\n\n        // Options to pass to https.connect if connecting via TLS\n        tlsOptions: {}\n    };\n\n    if (config) {\n        var tlsOptions;\n        if (config.tlsOptions) {\n          tlsOptions = config.tlsOptions;\n          delete config.tlsOptions;\n        }\n        else {\n          tlsOptions = {};\n        }\n        extend(this.config, config);\n        extend(this.config.tlsOptions, tlsOptions);\n    }\n\n    this._req = null;\n    \n    switch (this.config.webSocketVersion) {\n        case 8:\n        case 13:\n            break;\n        default:\n            throw new Error('Requested webSocketVersion is not supported. Allowed values are 8 and 13.');\n    }\n}\n\nutil.inherits(WebSocketClient, EventEmitter);\n\nWebSocketClient.prototype.connect = function(requestUrl, protocols, origin, headers, extraRequestOptions) {\n    var self = this;\n    \n    if (typeof(protocols) === 'string') {\n        if (protocols.length > 0) {\n            protocols = [protocols];\n        }\n        else {\n            protocols = [];\n        }\n    }\n    if (!(protocols instanceof Array)) {\n        protocols = [];\n    }\n    this.protocols = protocols;\n    this.origin = origin;\n\n    if (typeof(requestUrl) === 'string') {\n        this.url = url.parse(requestUrl);\n    }\n    else {\n        this.url = requestUrl; // in case an already parsed url is passed in.\n    }\n    if (!this.url.protocol) {\n        throw new Error('You must specify a full WebSocket URL, including protocol.');\n    }\n    if (!this.url.host) {\n        throw new Error('You must specify a full WebSocket URL, including hostname. Relative URLs are not supported.');\n    }\n\n    this.secure = (this.url.protocol === 'wss:');\n\n    // validate protocol characters:\n    this.protocols.forEach(function(protocol) {\n        for (var i=0; i < protocol.length; i ++) {\n            var charCode = protocol.charCodeAt(i);\n            var character = protocol.charAt(i);\n            if (charCode < 0x0021 || charCode > 0x007E || protocolSeparators.indexOf(character) !== -1) {\n                throw new Error('Protocol list contains invalid character \"' + String.fromCharCode(charCode) + '\"');\n            }\n        }\n    });\n\n    var defaultPorts = {\n        'ws:': '80',\n        'wss:': '443'\n    };\n\n    if (!this.url.port) {\n        this.url.port = defaultPorts[this.url.protocol];\n    }\n\n    var nonce = bufferAllocUnsafe(16);\n    for (var i=0; i < 16; i++) {\n        nonce[i] = Math.round(Math.random()*0xFF);\n    }\n    this.base64nonce = nonce.toString('base64');\n\n    var hostHeaderValue = this.url.hostname;\n    if ((this.url.protocol === 'ws:' && this.url.port !== '80') ||\n        (this.url.protocol === 'wss:' && this.url.port !== '443'))  {\n        hostHeaderValue += (':' + this.url.port);\n    }\n\n    var reqHeaders = {};\n    if (this.secure && this.config.tlsOptions.hasOwnProperty('headers')) {\n      // Allow for additional headers to be provided when connecting via HTTPS\n      extend(reqHeaders, this.config.tlsOptions.headers);\n    }\n    if (headers) {\n      // Explicitly provided headers take priority over any from tlsOptions\n      extend(reqHeaders, headers);\n    }\n    extend(reqHeaders, {\n        'Upgrade': 'websocket',\n        'Connection': 'Upgrade',\n        'Sec-WebSocket-Version': this.config.webSocketVersion.toString(10),\n        'Sec-WebSocket-Key': this.base64nonce,\n        'Host': reqHeaders.Host || hostHeaderValue\n    });\n\n    if (this.protocols.length > 0) {\n        reqHeaders['Sec-WebSocket-Protocol'] = this.protocols.join(', ');\n    }\n    if (this.origin) {\n        if (this.config.webSocketVersion === 13) {\n            reqHeaders['Origin'] = this.origin;\n        }\n        else if (this.config.webSocketVersion === 8) {\n            reqHeaders['Sec-WebSocket-Origin'] = this.origin;\n        }\n    }\n\n    // TODO: Implement extensions\n\n    var pathAndQuery;\n    // Ensure it begins with '/'.\n    if (this.url.pathname) {\n        pathAndQuery = this.url.path;\n    }\n    else if (this.url.path) {\n        pathAndQuery = '/' + this.url.path;\n    }\n    else {\n        pathAndQuery = '/';\n    }\n\n    function handleRequestError(error) {\n        self._req = null;\n        self.emit('connectFailed', error);\n    }\n\n    var requestOptions = {\n        agent: false\n    };\n    if (extraRequestOptions) {\n        extend(requestOptions, extraRequestOptions);\n    }\n    // These options are always overridden by the library.  The user is not\n    // allowed to specify these directly.\n    extend(requestOptions, {\n        hostname: this.url.hostname,\n        port: this.url.port,\n        method: 'GET',\n        path: pathAndQuery,\n        headers: reqHeaders\n    });\n    if (this.secure) {\n        var tlsOptions = this.config.tlsOptions;\n        for (var key in tlsOptions) {\n            if (tlsOptions.hasOwnProperty(key) && excludedTlsOptions.indexOf(key) === -1) {\n                requestOptions[key] = tlsOptions[key];\n            }\n        }\n    }\n\n    var req = this._req = (this.secure ? https : http).request(requestOptions);\n    req.on('upgrade', function handleRequestUpgrade(response, socket, head) {\n        self._req = null;\n        req.removeListener('error', handleRequestError);\n        self.socket = socket;\n        self.response = response;\n        self.firstDataChunk = head;\n        self.validateHandshake();\n    });\n    req.on('error', handleRequestError);\n\n    req.on('response', function(response) {\n        self._req = null;\n        if (utils.eventEmitterListenerCount(self, 'httpResponse') > 0) {\n            self.emit('httpResponse', response, self);\n            if (response.socket) {\n                response.socket.end();\n            }\n        }\n        else {\n            var headerDumpParts = [];\n            for (var headerName in response.headers) {\n                headerDumpParts.push(headerName + ': ' + response.headers[headerName]);\n            }\n            self.failHandshake(\n                'Server responded with a non-101 status: ' +\n                response.statusCode + ' ' + response.statusMessage +\n                '\\nResponse Headers Follow:\\n' +\n                headerDumpParts.join('\\n') + '\\n'\n            );\n        }\n    });\n    req.end();\n};\n\nWebSocketClient.prototype.validateHandshake = function() {\n    var headers = this.response.headers;\n\n    if (this.protocols.length > 0) {\n        this.protocol = headers['sec-websocket-protocol'];\n        if (this.protocol) {\n            if (this.protocols.indexOf(this.protocol) === -1) {\n                this.failHandshake('Server did not respond with a requested protocol.');\n                return;\n            }\n        }\n        else {\n            this.failHandshake('Expected a Sec-WebSocket-Protocol header.');\n            return;\n        }\n    }\n\n    if (!(headers['connection'] && headers['connection'].toLocaleLowerCase() === 'upgrade')) {\n        this.failHandshake('Expected a Connection: Upgrade header from the server');\n        return;\n    }\n\n    if (!(headers['upgrade'] && headers['upgrade'].toLocaleLowerCase() === 'websocket')) {\n        this.failHandshake('Expected an Upgrade: websocket header from the server');\n        return;\n    }\n\n    var sha1 = crypto.createHash('sha1');\n    sha1.update(this.base64nonce + '258EAFA5-E914-47DA-95CA-C5AB0DC85B11');\n    var expectedKey = sha1.digest('base64');\n\n    if (!headers['sec-websocket-accept']) {\n        this.failHandshake('Expected Sec-WebSocket-Accept header from server');\n        return;\n    }\n\n    if (headers['sec-websocket-accept'] !== expectedKey) {\n        this.failHandshake('Sec-WebSocket-Accept header from server didn\\'t match expected value of ' + expectedKey);\n        return;\n    }\n\n    // TODO: Support extensions\n\n    this.succeedHandshake();\n};\n\nWebSocketClient.prototype.failHandshake = function(errorDescription) {\n    if (this.socket && this.socket.writable) {\n        this.socket.end();\n    }\n    this.emit('connectFailed', new Error(errorDescription));\n};\n\nWebSocketClient.prototype.succeedHandshake = function() {\n    var connection = new WebSocketConnection(this.socket, [], this.protocol, true, this.config);\n\n    connection.webSocketVersion = this.config.webSocketVersion;\n    connection._addSocketEventListeners();\n\n    this.emit('connect', connection);\n    if (this.firstDataChunk.length > 0) {\n        connection.handleSocketData(this.firstDataChunk);\n    }\n    this.firstDataChunk = null;\n};\n\nWebSocketClient.prototype.abort = function() {\n    if (this._req) {\n        this._req.abort();\n    }\n};\n\nmodule.exports = WebSocketClient;\n"],"names":["utils","require","extend","util","EventEmitter","http","https","url","crypto","WebSocketConnection","bufferAllocUnsafe","protocolSeparators","String","fromCharCode","excludedTlsOptions","WebSocketClient","config","call","maxReceivedFrameSize","maxReceivedMessageSize","fragmentOutgoingMessages","fragmentationThreshold","webSocketVersion","assembleFragments","disableNagleAlgorithm","closeTimeout","tlsOptions","_req","Error","inherits","prototype","connect","requestUrl","protocols","origin","headers","extraRequestOptions","self","length","Array","parse","protocol","host","secure","forEach","i","charCode","charCodeAt","character","charAt","indexOf","defaultPorts","port","nonce","Math","round","random","base64nonce","toString","hostHeaderValue","hostname","reqHeaders","hasOwnProperty","Host","join","pathAndQuery","pathname","path","handleRequestError","error","emit","requestOptions","agent","method","key","req","request","on","handleRequestUpgrade","response","socket","head","removeListener","firstDataChunk","validateHandshake","eventEmitterListenerCount","end","headerDumpParts","headerName","push","failHandshake","statusCode","statusMessage","toLocaleLowerCase","sha1","createHash","update","expectedKey","digest","succeedHandshake","errorDescription","writable","connection","_addSocketEventListeners","handleSocketData","abort","module","exports"],"mappings":"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"}