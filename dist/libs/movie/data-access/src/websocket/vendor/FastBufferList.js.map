{"version":3,"sources":["../../../../../../../libs/movie/data-access/node_modules/websocket/vendor/FastBufferList.js"],"sourcesContent":["// This file was copied from https://github.com/substack/node-bufferlist\n// and modified to be able to copy bytes from the bufferlist directly into\n// a pre-existing fixed-size buffer without an additional memory allocation.\n\n// bufferlist.js\n// Treat a linked list of buffers as a single variable-size buffer.\nvar Buffer = require('buffer').Buffer;\nvar EventEmitter = require('events').EventEmitter;\nvar bufferAllocUnsafe = require('../lib/utils').bufferAllocUnsafe;\n\nmodule.exports = BufferList;\nmodule.exports.BufferList = BufferList; // backwards compatibility\n\nfunction BufferList(opts) {\n    if (!(this instanceof BufferList)) return new BufferList(opts);\n    EventEmitter.call(this);\n    var self = this;\n    \n    if (typeof(opts) == 'undefined') opts = {};\n    \n    // default encoding to use for take(). Leaving as 'undefined'\n    // makes take() return a Buffer instead.\n    self.encoding = opts.encoding;\n    \n    var head = { next : null, buffer : null };\n    var last = { next : null, buffer : null };\n    \n    // length can get negative when advanced past the end\n    // and this is the desired behavior\n    var length = 0;\n    self.__defineGetter__('length', function () {\n        return length;\n    });\n    \n    // keep an offset of the head to decide when to head = head.next\n    var offset = 0;\n    \n    // Write to the bufferlist. Emits 'write'. Always returns true.\n    self.write = function (buf) {\n        if (!head.buffer) {\n            head.buffer = buf;\n            last = head;\n        }\n        else {\n            last.next = { next : null, buffer : buf };\n            last = last.next;\n        }\n        length += buf.length;\n        self.emit('write', buf);\n        return true;\n    };\n    \n    self.end = function (buf) {\n        if (Buffer.isBuffer(buf)) self.write(buf);\n    };\n    \n    // Push buffers to the end of the linked list. (deprecated)\n    // Return this (self).\n    self.push = function () {\n        var args = [].concat.apply([], arguments);\n        args.forEach(self.write);\n        return self;\n    };\n    \n    // For each buffer, perform some action.\n    // If fn's result is a true value, cut out early.\n    // Returns this (self).\n    self.forEach = function (fn) {\n        if (!head.buffer) return bufferAllocUnsafe(0);\n        \n        if (head.buffer.length - offset <= 0) return self;\n        var firstBuf = head.buffer.slice(offset);\n        \n        var b = { buffer : firstBuf, next : head.next };\n        \n        while (b && b.buffer) {\n            var r = fn(b.buffer);\n            if (r) break;\n            b = b.next;\n        }\n        \n        return self;\n    };\n    \n    // Create a single Buffer out of all the chunks or some subset specified by\n    // start and one-past the end (like slice) in bytes.\n    self.join = function (start, end) {\n        if (!head.buffer) return bufferAllocUnsafe(0);\n        if (start == undefined) start = 0;\n        if (end == undefined) end = self.length;\n        \n        var big = bufferAllocUnsafe(end - start);\n        var ix = 0;\n        self.forEach(function (buffer) {\n            if (start < (ix + buffer.length) && ix < end) {\n                // at least partially contained in the range\n                buffer.copy(\n                    big,\n                    Math.max(0, ix - start),\n                    Math.max(0, start - ix),\n                    Math.min(buffer.length, end - ix)\n                );\n            }\n            ix += buffer.length;\n            if (ix > end) return true; // stop processing past end\n        });\n        \n        return big;\n    };\n    \n    self.joinInto = function (targetBuffer, targetStart, sourceStart, sourceEnd) {\n        if (!head.buffer) return new bufferAllocUnsafe(0);\n        if (sourceStart == undefined) sourceStart = 0;\n        if (sourceEnd == undefined) sourceEnd = self.length;\n        \n        var big = targetBuffer;\n        if (big.length - targetStart < sourceEnd - sourceStart) {\n            throw new Error(\"Insufficient space available in target Buffer.\");\n        }\n        var ix = 0;\n        self.forEach(function (buffer) {\n            if (sourceStart < (ix + buffer.length) && ix < sourceEnd) {\n                // at least partially contained in the range\n                buffer.copy(\n                    big,\n                    Math.max(targetStart, targetStart + ix - sourceStart),\n                    Math.max(0, sourceStart - ix),\n                    Math.min(buffer.length, sourceEnd - ix)\n                );\n            }\n            ix += buffer.length;\n            if (ix > sourceEnd) return true; // stop processing past end\n        });\n        \n        return big;\n    };\n    \n    // Advance the buffer stream by n bytes.\n    // If n the aggregate advance offset passes the end of the buffer list,\n    // operations such as .take() will return empty strings until enough data is\n    // pushed.\n    // Returns this (self).\n    self.advance = function (n) {\n        offset += n;\n        length -= n;\n        while (head.buffer && offset >= head.buffer.length) {\n            offset -= head.buffer.length;\n            head = head.next\n                ? head.next\n                : { buffer : null, next : null }\n            ;\n        }\n        if (head.buffer === null) last = { next : null, buffer : null };\n        self.emit('advance', n);\n        return self;\n    };\n    \n    // Take n bytes from the start of the buffers.\n    // Returns a string.\n    // If there are less than n bytes in all the buffers or n is undefined,\n    // returns the entire concatenated buffer string.\n    self.take = function (n, encoding) {\n        if (n == undefined) n = self.length;\n        else if (typeof n !== 'number') {\n            encoding = n;\n            n = self.length;\n        }\n        var b = head;\n        if (!encoding) encoding = self.encoding;\n        if (encoding) {\n            var acc = '';\n            self.forEach(function (buffer) {\n                if (n <= 0) return true;\n                acc += buffer.toString(\n                    encoding, 0, Math.min(n,buffer.length)\n                );\n                n -= buffer.length;\n            });\n            return acc;\n        } else {\n            // If no 'encoding' is specified, then return a Buffer.\n            return self.join(0, n);\n        }\n    };\n    \n    // The entire concatenated buffer as a string.\n    self.toString = function () {\n        return self.take('binary');\n    };\n}\nrequire('util').inherits(BufferList, EventEmitter);\n"],"names":["Buffer","require","EventEmitter","bufferAllocUnsafe","module","exports","BufferList","opts","call","self","encoding","head","next","buffer","last","length","__defineGetter__","offset","write","buf","emit","end","isBuffer","push","args","concat","apply","arguments","forEach","fn","firstBuf","slice","b","r","join","start","undefined","big","ix","copy","Math","max","min","joinInto","targetBuffer","targetStart","sourceStart","sourceEnd","Error","advance","n","take","acc","toString","inherits"],"mappings":"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"}