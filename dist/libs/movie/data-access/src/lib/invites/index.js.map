{"version":3,"sources":["../../../../../../../libs/movie/data-access/src/lib/invites/index.ts"],"sourcesContent":["// import { sbClient } from '@core/utils';\nimport { getClient } from \"../../utils\";\n\nimport { v4 as uuid } from \"uuid\";\n\nexport enum ROLE {\n  ADMIN = \"ADMIN\",\n  USER = \"USER\",\n}\n\nconst sbClient = getClient();\n\ntype Role = \"ADMIN\" | \"USER\";\n\nexport async function createInviteLink(\n  userId: string,\n  groupId: number,\n  role: Role\n): Promise<[string, any]> {\n  const inviteId = uuid();\n  const { error } = await sbClient\n    .from(\"invites\")\n    .insert({ owner_id: userId, group_id: groupId, role, invite_id: inviteId });\n  if (error) {\n    await sbClient\n      .from(\"invites\")\n      .delete()\n      .eq(\"group_id\", groupId)\n      .eq(\"owner_id\", userId);\n    return createInviteLink(userId, groupId, role);\n  }\n  return [\n    `${window.location.host}/app/invite/group?invite_id=${inviteId}`,\n    error,\n  ];\n}\n\nexport async function getInviteInfo(inviteId: string) {\n  const { data, error } = await sbClient\n    .from(\"invites\")\n    .select()\n    .eq(\"invite_id\", inviteId)\n    .maybeSingle();\n  return [data, error];\n}\n\nexport async function removeInvite(inviteId: string) {\n  const { data, error } = await sbClient\n    .from(\"invites\")\n    .delete()\n    .eq(\"invite_id\", inviteId);\n  return [data, error];\n}\n"],"names":["createInviteLink","getInviteInfo","removeInvite","ROLE","ADMIN","USER","sbClient","getClient","userId","groupId","role","inviteId","uuid","error","from","insert","owner_id","group_id","invite_id","delete","eq","window","location","host","data","select","maybeSingle"],"mappings":";QAcsBA,gBAAgB,GAAhBA,gBAAgB;QAuBhBC,aAAa,GAAbA,aAAa;QASbC,YAAY,GAAZA,YAAY;;AA7CR,GAAa,CAAb,MAAa;AAEZ,GAAM,CAAN,KAAM;;;UAErBC,IAAI;IAAJA,IAAI,CACdC,CAAK,UAALA,CAAK;IADKD,IAAI,CAEdE,CAAI,SAAJA,CAAI;GAFMF,IAAI,oBAAJA,IAAI;AAKhB,KAAK,CAACG,QAAQ,OAAGC,MAAS;eAIJP,gBAAgB,CACpCQ,MAAc,EACdC,OAAe,EACfC,IAAU,EACc,CAAC;IACzB,KAAK,CAACC,QAAQ,OAAGC,KAAI;IACrB,KAAK,CAAC,CAAC,CAACC,KAAK,EAAC,CAAC,GAAG,KAAK,CAACP,QAAQ,CAC7BQ,IAAI,CAAC,CAAS,UACdC,MAAM,CAAC,CAAC;QAACC,QAAQ,EAAER,MAAM;QAAES,QAAQ,EAAER,OAAO;QAAEC,IAAI;QAAEQ,SAAS,EAAEP,QAAQ;IAAC,CAAC;IAC5E,EAAE,EAAEE,KAAK,EAAE,CAAC;QACV,KAAK,CAACP,QAAQ,CACXQ,IAAI,CAAC,CAAS,UACdK,MAAM,GACNC,EAAE,CAAC,CAAU,WAAEX,OAAO,EACtBW,EAAE,CAAC,CAAU,WAAEZ,MAAM;QACxB,MAAM,CAACR,gBAAgB,CAACQ,MAAM,EAAEC,OAAO,EAAEC,IAAI;IAC/C,CAAC;IACD,MAAM,CAAC,CAAC;WACHW,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAC,4BAA4B,EAAEZ,QAAQ;QAC9DE,KAAK;IACP,CAAC;AACH,CAAC;eAEqBZ,aAAa,CAACU,QAAgB,EAAE,CAAC;IACrD,KAAK,CAAC,CAAC,CAACa,IAAI,GAAEX,KAAK,EAAC,CAAC,GAAG,KAAK,CAACP,QAAQ,CACnCQ,IAAI,CAAC,CAAS,UACdW,MAAM,GACNL,EAAE,CAAC,CAAW,YAAET,QAAQ,EACxBe,WAAW;IACd,MAAM,CAAC,CAACF;QAAAA,IAAI;QAAEX,KAAK;IAAA,CAAC;AACtB,CAAC;eAEqBX,YAAY,CAACS,QAAgB,EAAE,CAAC;IACpD,KAAK,CAAC,CAAC,CAACa,IAAI,GAAEX,KAAK,EAAC,CAAC,GAAG,KAAK,CAACP,QAAQ,CACnCQ,IAAI,CAAC,CAAS,UACdK,MAAM,GACNC,EAAE,CAAC,CAAW,YAAET,QAAQ;IAC3B,MAAM,CAAC,CAACa;QAAAA,IAAI;QAAEX,KAAK;IAAA,CAAC;AACtB,CAAC"}