{"version":3,"sources":["../../../../../../../../../libs/movie/data-access/node_modules/broadcast-channel/dist/lib/methods/node.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\n/**\n * this method is used in nodejs-environments.\n * The ipc is handled via sockets and file-writes to the tmp-folder\n */\nvar util = require('util');\n\nvar fs = require('fs');\n\nvar os = require('os');\n\nvar events = require('events');\n\nvar net = require('net');\n\nvar path = require('path');\n\nvar micro = require('nano-time');\n\nvar rimraf = require('rimraf');\n\nvar sha3_224 = require('js-sha3').sha3_224;\n\nvar isNode = require('detect-node');\n\nvar unload = require('unload');\n\nvar fillOptionsWithDefaults = require('../../dist/lib/options.js').fillOptionsWithDefaults;\n\nvar ownUtil = require('../../dist/lib/util.js');\n\nvar randomInt = ownUtil.randomInt;\nvar randomToken = ownUtil.randomToken;\n\nvar _require = require('oblivious-set'),\n    ObliviousSet = _require.ObliviousSet;\n/**\n * windows sucks, so we have handle windows-type of socket-paths\n * @link https://gist.github.com/domenic/2790533#gistcomment-331356\n */\n\n\nfunction cleanPipeName(str) {\n  if (process.platform === 'win32' && !str.startsWith('\\\\\\\\.\\\\pipe\\\\')) {\n    str = str.replace(/^\\//, '');\n    str = str.replace(/\\//g, '-');\n    return '\\\\\\\\.\\\\pipe\\\\' + str;\n  } else {\n    return str;\n  }\n}\n\nvar mkdir = util.promisify(fs.mkdir);\nvar writeFile = util.promisify(fs.writeFile);\nvar readFile = util.promisify(fs.readFile);\nvar unlink = util.promisify(fs.unlink);\nvar readdir = util.promisify(fs.readdir);\nvar chmod = util.promisify(fs.chmod);\nvar removeDir = util.promisify(rimraf);\nvar OTHER_INSTANCES = {};\nvar TMP_FOLDER_NAME = 'pubkey.bc';\nvar TMP_FOLDER_BASE = path.join(os.tmpdir(), TMP_FOLDER_NAME);\nvar getPathsCache = new Map();\n\nfunction getPaths(channelName) {\n  if (!getPathsCache.has(channelName)) {\n    var channelHash = sha3_224(channelName); // use hash incase of strange characters\n\n    /**\n     * because the lenght of socket-paths is limited, we use only the first 20 chars\n     * and also start with A to ensure we do not start with a number\n     * @link https://serverfault.com/questions/641347/check-if-a-path-exceeds-maximum-for-unix-domain-socket\n     */\n\n    var channelFolder = 'A' + channelHash.substring(0, 20);\n    var channelPathBase = path.join(TMP_FOLDER_BASE, channelFolder);\n    var folderPathReaders = path.join(channelPathBase, 'rdrs');\n    var folderPathMessages = path.join(channelPathBase, 'messages');\n    var ret = {\n      channelBase: channelPathBase,\n      readers: folderPathReaders,\n      messages: folderPathMessages\n    };\n    getPathsCache.set(channelName, ret);\n    return ret;\n  }\n\n  return getPathsCache.get(channelName);\n}\n\nvar ENSURE_BASE_FOLDER_EXISTS_PROMISE = null;\n\nfunction ensureBaseFolderExists() {\n  return _ensureBaseFolderExists.apply(this, arguments);\n}\n\nfunction _ensureBaseFolderExists() {\n  _ensureBaseFolderExists = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee4() {\n    return _regenerator[\"default\"].wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            if (!ENSURE_BASE_FOLDER_EXISTS_PROMISE) {\n              ENSURE_BASE_FOLDER_EXISTS_PROMISE = mkdir(TMP_FOLDER_BASE)[\"catch\"](function () {\n                return null;\n              });\n            }\n\n            return _context4.abrupt(\"return\", ENSURE_BASE_FOLDER_EXISTS_PROMISE);\n\n          case 2:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n  return _ensureBaseFolderExists.apply(this, arguments);\n}\n\nfunction ensureFoldersExist(_x, _x2) {\n  return _ensureFoldersExist.apply(this, arguments);\n}\n/**\n * removes the tmp-folder\n * @return {Promise<true>}\n */\n\n\nfunction _ensureFoldersExist() {\n  _ensureFoldersExist = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee5(channelName, paths) {\n    var chmodValue;\n    return _regenerator[\"default\"].wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            paths = paths || getPaths(channelName);\n            _context5.next = 3;\n            return ensureBaseFolderExists();\n\n          case 3:\n            _context5.next = 5;\n            return mkdir(paths.channelBase)[\"catch\"](function () {\n              return null;\n            });\n\n          case 5:\n            _context5.next = 7;\n            return Promise.all([mkdir(paths.readers)[\"catch\"](function () {\n              return null;\n            }), mkdir(paths.messages)[\"catch\"](function () {\n              return null;\n            })]);\n\n          case 7:\n            // set permissions so other users can use the same channel\n            chmodValue = '777';\n            _context5.next = 10;\n            return Promise.all([chmod(paths.channelBase, chmodValue), chmod(paths.readers, chmodValue), chmod(paths.messages, chmodValue)])[\"catch\"](function () {\n              return null;\n            });\n\n          case 10:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5);\n  }));\n  return _ensureFoldersExist.apply(this, arguments);\n}\n\nfunction clearNodeFolder() {\n  return _clearNodeFolder.apply(this, arguments);\n}\n\nfunction _clearNodeFolder() {\n  _clearNodeFolder = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee6() {\n    return _regenerator[\"default\"].wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            if (!(!TMP_FOLDER_BASE || TMP_FOLDER_BASE === '' || TMP_FOLDER_BASE === '/')) {\n              _context6.next = 2;\n              break;\n            }\n\n            throw new Error('BroadcastChannel.clearNodeFolder(): path is wrong');\n\n          case 2:\n            ENSURE_BASE_FOLDER_EXISTS_PROMISE = null;\n            _context6.next = 5;\n            return removeDir(TMP_FOLDER_BASE);\n\n          case 5:\n            ENSURE_BASE_FOLDER_EXISTS_PROMISE = null;\n            return _context6.abrupt(\"return\", true);\n\n          case 7:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6);\n  }));\n  return _clearNodeFolder.apply(this, arguments);\n}\n\nfunction socketPath(channelName, readerUuid, paths) {\n  paths = paths || getPaths(channelName);\n  var socketPath = path.join(paths.readers, readerUuid + '.s');\n  return cleanPipeName(socketPath);\n}\n\nfunction socketInfoPath(channelName, readerUuid, paths) {\n  paths = paths || getPaths(channelName);\n  var socketPath = path.join(paths.readers, readerUuid + '.json');\n  return socketPath;\n}\n/**\n * Because it is not possible to get all socket-files in a folder,\n * when used under fucking windows,\n * we have to set a normal file so other readers know our socket exists\n */\n\n\nfunction createSocketInfoFile(channelName, readerUuid, paths) {\n  var pathToFile = socketInfoPath(channelName, readerUuid, paths);\n  return writeFile(pathToFile, JSON.stringify({\n    time: microSeconds()\n  })).then(function () {\n    return pathToFile;\n  });\n}\n/**\n * returns the amount of channel-folders in the tmp-directory\n * @return {Promise<number>}\n */\n\n\nfunction countChannelFolders() {\n  return _countChannelFolders.apply(this, arguments);\n}\n\nfunction _countChannelFolders() {\n  _countChannelFolders = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee7() {\n    var folders;\n    return _regenerator[\"default\"].wrap(function _callee7$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            _context7.next = 2;\n            return ensureBaseFolderExists();\n\n          case 2:\n            _context7.next = 4;\n            return readdir(TMP_FOLDER_BASE);\n\n          case 4:\n            folders = _context7.sent;\n            return _context7.abrupt(\"return\", folders.length);\n\n          case 6:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee7);\n  }));\n  return _countChannelFolders.apply(this, arguments);\n}\n\nfunction connectionError(_x3) {\n  return _connectionError.apply(this, arguments);\n}\n/**\n * creates the socket-file and subscribes to it\n * @return {{emitter: EventEmitter, server: any}}\n */\n\n\nfunction _connectionError() {\n  _connectionError = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee8(originalError) {\n    var count, addObj, text, newError;\n    return _regenerator[\"default\"].wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            _context8.next = 2;\n            return countChannelFolders();\n\n          case 2:\n            count = _context8.sent;\n\n            if (!(count < 30)) {\n              _context8.next = 5;\n              break;\n            }\n\n            return _context8.abrupt(\"return\", originalError);\n\n          case 5:\n            addObj = {};\n            Object.entries(originalError).forEach(function (_ref4) {\n              var k = _ref4[0],\n                  v = _ref4[1];\n              return addObj[k] = v;\n            });\n            text = 'BroadcastChannel.create(): error: ' + 'This might happen if you have created to many channels, ' + 'like when you use BroadcastChannel in unit-tests.' + 'Try using BroadcastChannel.clearNodeFolder() to clear the tmp-folder before each test.' + 'See https://github.com/pubkey/broadcast-channel#clear-tmp-folder';\n            newError = new Error(text + ': ' + JSON.stringify(addObj, null, 2));\n            return _context8.abrupt(\"return\", newError);\n\n          case 10:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8);\n  }));\n  return _connectionError.apply(this, arguments);\n}\n\nfunction createSocketEventEmitter(_x4, _x5, _x6) {\n  return _createSocketEventEmitter.apply(this, arguments);\n}\n\nfunction _createSocketEventEmitter() {\n  _createSocketEventEmitter = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee11(channelName, readerUuid, paths) {\n    var pathToSocket, emitter, server;\n    return _regenerator[\"default\"].wrap(function _callee11$(_context11) {\n      while (1) {\n        switch (_context11.prev = _context11.next) {\n          case 0:\n            pathToSocket = socketPath(channelName, readerUuid, paths);\n            emitter = new events.EventEmitter();\n            server = net.createServer(function (stream) {\n              stream.on('end', function () {});\n              stream.on('data', function (msg) {\n                emitter.emit('data', msg.toString());\n              });\n            });\n            _context11.next = 5;\n            return new Promise(function (resolve, reject) {\n              server.on('error', /*#__PURE__*/function () {\n                var _ref5 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee9(err) {\n                  var useErr;\n                  return _regenerator[\"default\"].wrap(function _callee9$(_context9) {\n                    while (1) {\n                      switch (_context9.prev = _context9.next) {\n                        case 0:\n                          _context9.next = 2;\n                          return connectionError(err);\n\n                        case 2:\n                          useErr = _context9.sent;\n                          reject(useErr);\n\n                        case 4:\n                        case \"end\":\n                          return _context9.stop();\n                      }\n                    }\n                  }, _callee9);\n                }));\n\n                return function (_x24) {\n                  return _ref5.apply(this, arguments);\n                };\n              }());\n              server.listen(pathToSocket, /*#__PURE__*/function () {\n                var _ref6 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee10(err, res) {\n                  var useErr;\n                  return _regenerator[\"default\"].wrap(function _callee10$(_context10) {\n                    while (1) {\n                      switch (_context10.prev = _context10.next) {\n                        case 0:\n                          if (!err) {\n                            _context10.next = 7;\n                            break;\n                          }\n\n                          _context10.next = 3;\n                          return connectionError(err);\n\n                        case 3:\n                          useErr = _context10.sent;\n                          reject(useErr);\n                          _context10.next = 8;\n                          break;\n\n                        case 7:\n                          resolve(res);\n\n                        case 8:\n                        case \"end\":\n                          return _context10.stop();\n                      }\n                    }\n                  }, _callee10);\n                }));\n\n                return function (_x25, _x26) {\n                  return _ref6.apply(this, arguments);\n                };\n              }());\n            });\n\n          case 5:\n            return _context11.abrupt(\"return\", {\n              path: pathToSocket,\n              emitter: emitter,\n              server: server\n            });\n\n          case 6:\n          case \"end\":\n            return _context11.stop();\n        }\n      }\n    }, _callee11);\n  }));\n  return _createSocketEventEmitter.apply(this, arguments);\n}\n\nfunction openClientConnection(_x7, _x8) {\n  return _openClientConnection.apply(this, arguments);\n}\n/**\n * writes the new message to the file-system\n * so other readers can find it\n * @return {Promise}\n */\n\n\nfunction _openClientConnection() {\n  _openClientConnection = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee12(channelName, readerUuid) {\n    var pathToSocket, client;\n    return _regenerator[\"default\"].wrap(function _callee12$(_context12) {\n      while (1) {\n        switch (_context12.prev = _context12.next) {\n          case 0:\n            pathToSocket = socketPath(channelName, readerUuid);\n            client = new net.Socket();\n            return _context12.abrupt(\"return\", new Promise(function (res, rej) {\n              client.connect(pathToSocket, function () {\n                return res(client);\n              });\n              client.on('error', function (err) {\n                return rej(err);\n              });\n            }));\n\n          case 3:\n          case \"end\":\n            return _context12.stop();\n        }\n      }\n    }, _callee12);\n  }));\n  return _openClientConnection.apply(this, arguments);\n}\n\nfunction writeMessage(channelName, readerUuid, messageJson, paths) {\n  paths = paths || getPaths(channelName);\n  var time = microSeconds();\n  var writeObject = {\n    uuid: readerUuid,\n    time: time,\n    data: messageJson\n  };\n  var token = randomToken();\n  var fileName = time + '_' + readerUuid + '_' + token + '.json';\n  var msgPath = path.join(paths.messages, fileName);\n  return writeFile(msgPath, JSON.stringify(writeObject)).then(function () {\n    return {\n      time: time,\n      uuid: readerUuid,\n      token: token,\n      path: msgPath\n    };\n  });\n}\n/**\n * returns the uuids of all readers\n * @return {string[]}\n */\n\n\nfunction getReadersUuids(_x9, _x10) {\n  return _getReadersUuids.apply(this, arguments);\n}\n\nfunction _getReadersUuids() {\n  _getReadersUuids = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee13(channelName, paths) {\n    var readersPath, files;\n    return _regenerator[\"default\"].wrap(function _callee13$(_context13) {\n      while (1) {\n        switch (_context13.prev = _context13.next) {\n          case 0:\n            paths = paths || getPaths(channelName);\n            readersPath = paths.readers;\n            _context13.next = 4;\n            return readdir(readersPath);\n\n          case 4:\n            files = _context13.sent;\n            return _context13.abrupt(\"return\", files.map(function (file) {\n              return file.split('.');\n            }).filter(function (split) {\n              return split[1] === 'json';\n            }) // do not scan .socket-files\n            . // do not scan .socket-files\n            map(function (split) {\n              return split[0];\n            }));\n\n          case 6:\n          case \"end\":\n            return _context13.stop();\n        }\n      }\n    }, _callee13);\n  }));\n  return _getReadersUuids.apply(this, arguments);\n}\n\nfunction messagePath(_x11, _x12, _x13, _x14) {\n  return _messagePath.apply(this, arguments);\n}\n\nfunction _messagePath() {\n  _messagePath = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee14(channelName, time, token, writerUuid) {\n    var fileName, msgPath;\n    return _regenerator[\"default\"].wrap(function _callee14$(_context14) {\n      while (1) {\n        switch (_context14.prev = _context14.next) {\n          case 0:\n            fileName = time + '_' + writerUuid + '_' + token + '.json';\n            msgPath = path.join(getPaths(channelName).messages, fileName);\n            return _context14.abrupt(\"return\", msgPath);\n\n          case 3:\n          case \"end\":\n            return _context14.stop();\n        }\n      }\n    }, _callee14);\n  }));\n  return _messagePath.apply(this, arguments);\n}\n\nfunction getAllMessages(_x15, _x16) {\n  return _getAllMessages.apply(this, arguments);\n}\n\nfunction _getAllMessages() {\n  _getAllMessages = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee15(channelName, paths) {\n    var messagesPath, files;\n    return _regenerator[\"default\"].wrap(function _callee15$(_context15) {\n      while (1) {\n        switch (_context15.prev = _context15.next) {\n          case 0:\n            paths = paths || getPaths(channelName);\n            messagesPath = paths.messages;\n            _context15.next = 4;\n            return readdir(messagesPath);\n\n          case 4:\n            files = _context15.sent;\n            return _context15.abrupt(\"return\", files.map(function (file) {\n              var fileName = file.split('.')[0];\n              var split = fileName.split('_');\n              return {\n                path: path.join(messagesPath, file),\n                time: parseInt(split[0]),\n                senderUuid: split[1],\n                token: split[2]\n              };\n            }));\n\n          case 6:\n          case \"end\":\n            return _context15.stop();\n        }\n      }\n    }, _callee15);\n  }));\n  return _getAllMessages.apply(this, arguments);\n}\n\nfunction getSingleMessage(channelName, msgObj, paths) {\n  paths = paths || getPaths(channelName);\n  return {\n    path: path.join(paths.messages, msgObj.t + '_' + msgObj.u + '_' + msgObj.to + '.json'),\n    time: msgObj.t,\n    senderUuid: msgObj.u,\n    token: msgObj.to\n  };\n}\n\nfunction readMessage(messageObj) {\n  return readFile(messageObj.path, 'utf8').then(function (content) {\n    return JSON.parse(content);\n  });\n}\n\nfunction cleanOldMessages(_x17, _x18) {\n  return _cleanOldMessages.apply(this, arguments);\n}\n\nfunction _cleanOldMessages() {\n  _cleanOldMessages = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee16(messageObjects, ttl) {\n    var olderThen;\n    return _regenerator[\"default\"].wrap(function _callee16$(_context16) {\n      while (1) {\n        switch (_context16.prev = _context16.next) {\n          case 0:\n            olderThen = Date.now() - ttl;\n            _context16.next = 3;\n            return Promise.all(messageObjects.filter(function (obj) {\n              return obj.time / 1000 < olderThen;\n            }).map(function (obj) {\n              return unlink(obj.path)[\"catch\"](function () {\n                return null;\n              });\n            }));\n\n          case 3:\n          case \"end\":\n            return _context16.stop();\n        }\n      }\n    }, _callee16);\n  }));\n  return _cleanOldMessages.apply(this, arguments);\n}\n\nvar type = 'node';\n/**\n * creates a new channelState\n * @return {Promise<any>}\n */\n\nfunction create(_x19) {\n  return _create.apply(this, arguments);\n}\n\nfunction _create() {\n  _create = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee17(channelName) {\n    var options,\n        time,\n        paths,\n        ensureFolderExistsPromise,\n        uuid,\n        state,\n        _yield$Promise$all2,\n        socketEE,\n        infoFilePath,\n        _args17 = arguments;\n\n    return _regenerator[\"default\"].wrap(function _callee17$(_context17) {\n      while (1) {\n        switch (_context17.prev = _context17.next) {\n          case 0:\n            options = _args17.length > 1 && _args17[1] !== undefined ? _args17[1] : {};\n            options = fillOptionsWithDefaults(options);\n            time = microSeconds();\n            paths = getPaths(channelName);\n            ensureFolderExistsPromise = ensureFoldersExist(channelName, paths);\n            uuid = randomToken();\n            state = {\n              time: time,\n              channelName: channelName,\n              options: options,\n              uuid: uuid,\n              paths: paths,\n              // contains all messages that have been emitted before\n              emittedMessagesIds: new ObliviousSet(options.node.ttl * 2),\n              messagesCallbackTime: null,\n              messagesCallback: null,\n              // ensures we do not read messages in parrallel\n              writeBlockPromise: Promise.resolve(),\n              otherReaderClients: {},\n              // ensure if process crashes, everything is cleaned up\n              removeUnload: unload.add(function () {\n                return close(state);\n              }),\n              closed: false\n            };\n            if (!OTHER_INSTANCES[channelName]) OTHER_INSTANCES[channelName] = [];\n            OTHER_INSTANCES[channelName].push(state);\n            _context17.next = 11;\n            return ensureFolderExistsPromise;\n\n          case 11:\n            _context17.next = 13;\n            return Promise.all([createSocketEventEmitter(channelName, uuid, paths), createSocketInfoFile(channelName, uuid, paths), refreshReaderClients(state)]);\n\n          case 13:\n            _yield$Promise$all2 = _context17.sent;\n            socketEE = _yield$Promise$all2[0];\n            infoFilePath = _yield$Promise$all2[1];\n            state.socketEE = socketEE;\n            state.infoFilePath = infoFilePath; // when new message comes in, we read it and emit it\n\n            socketEE.emitter.on('data', function (data) {\n              // if the socket is used fast, it may appear that multiple messages are flushed at once\n              // so we have to split them before\n              var singleOnes = data.split('|');\n              singleOnes.filter(function (single) {\n                return single !== '';\n              }).forEach(function (single) {\n                try {\n                  var obj = JSON.parse(single);\n                  handleMessagePing(state, obj);\n                } catch (err) {\n                  throw new Error('could not parse data: ' + single);\n                }\n              });\n            });\n            return _context17.abrupt(\"return\", state);\n\n          case 20:\n          case \"end\":\n            return _context17.stop();\n        }\n      }\n    }, _callee17);\n  }));\n  return _create.apply(this, arguments);\n}\n\nfunction _filterMessage(msgObj, state) {\n  if (msgObj.senderUuid === state.uuid) return false; // not send by own\n\n  if (state.emittedMessagesIds.has(msgObj.token)) return false; // not already emitted\n\n  if (!state.messagesCallback) return false; // no listener\n\n  if (msgObj.time < state.messagesCallbackTime) return false; // not older then onMessageCallback\n\n  if (msgObj.time < state.time) return false; // msgObj is older then channel\n\n  state.emittedMessagesIds.add(msgObj.token);\n  return true;\n}\n/**\n * when the socket pings, so that we now new messages came,\n * run this\n */\n\n\nfunction handleMessagePing(_x20, _x21) {\n  return _handleMessagePing.apply(this, arguments);\n}\n/**\n * ensures that the channelState is connected with all other readers\n * @return {Promise<void>}\n */\n\n\nfunction _handleMessagePing() {\n  _handleMessagePing = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee18(state, msgObj) {\n    var messages, useMessages;\n    return _regenerator[\"default\"].wrap(function _callee18$(_context18) {\n      while (1) {\n        switch (_context18.prev = _context18.next) {\n          case 0:\n            if (state.messagesCallback) {\n              _context18.next = 2;\n              break;\n            }\n\n            return _context18.abrupt(\"return\");\n\n          case 2:\n            if (msgObj) {\n              _context18.next = 8;\n              break;\n            }\n\n            _context18.next = 5;\n            return getAllMessages(state.channelName, state.paths);\n\n          case 5:\n            messages = _context18.sent;\n            _context18.next = 9;\n            break;\n\n          case 8:\n            // get single message\n            messages = [getSingleMessage(state.channelName, msgObj, state.paths)];\n\n          case 9:\n            useMessages = messages.filter(function (msgObj) {\n              return _filterMessage(msgObj, state);\n            }).sort(function (msgObjA, msgObjB) {\n              return msgObjA.time - msgObjB.time;\n            }); // sort by time\n            // if no listener or message, so not do anything\n\n            if (!(!useMessages.length || !state.messagesCallback)) {\n              _context18.next = 12;\n              break;\n            }\n\n            return _context18.abrupt(\"return\");\n\n          case 12:\n            _context18.next = 14;\n            return Promise.all(useMessages.map(function (msgObj) {\n              return readMessage(msgObj).then(function (content) {\n                return msgObj.content = content;\n              });\n            }));\n\n          case 14:\n            useMessages.forEach(function (msgObj) {\n              state.emittedMessagesIds.add(msgObj.token);\n\n              if (state.messagesCallback) {\n                // emit to subscribers\n                state.messagesCallback(msgObj.content.data);\n              }\n            });\n\n          case 15:\n          case \"end\":\n            return _context18.stop();\n        }\n      }\n    }, _callee18);\n  }));\n  return _handleMessagePing.apply(this, arguments);\n}\n\nfunction refreshReaderClients(channelState) {\n  return getReadersUuids(channelState.channelName, channelState.paths).then(function (otherReaders) {\n    // remove subscriptions to closed readers\n    Object.keys(channelState.otherReaderClients).filter(function (readerUuid) {\n      return !otherReaders.includes(readerUuid);\n    }).forEach( /*#__PURE__*/function () {\n      var _ref = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee(readerUuid) {\n        return _regenerator[\"default\"].wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return channelState.otherReaderClients[readerUuid].destroy();\n\n              case 3:\n                _context.next = 7;\n                break;\n\n              case 5:\n                _context.prev = 5;\n                _context.t0 = _context[\"catch\"](0);\n\n              case 7:\n                delete channelState.otherReaderClients[readerUuid];\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 5]]);\n      }));\n\n      return function (_x22) {\n        return _ref.apply(this, arguments);\n      };\n    }()); // add new readers\n\n    return Promise.all(otherReaders.filter(function (readerUuid) {\n      return readerUuid !== channelState.uuid;\n    }) // not own\n    .filter(function (readerUuid) {\n      return !channelState.otherReaderClients[readerUuid];\n    }) // not already has client\n    .map( /*#__PURE__*/function () {\n      var _ref2 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee2(readerUuid) {\n        var client;\n        return _regenerator[\"default\"].wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n\n                if (!channelState.closed) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 3:\n                _context2.prev = 3;\n                _context2.next = 6;\n                return openClientConnection(channelState.channelName, readerUuid);\n\n              case 6:\n                client = _context2.sent;\n                channelState.otherReaderClients[readerUuid] = client;\n                _context2.next = 12;\n                break;\n\n              case 10:\n                _context2.prev = 10;\n                _context2.t0 = _context2[\"catch\"](3);\n\n              case 12:\n                _context2.next = 16;\n                break;\n\n              case 14:\n                _context2.prev = 14;\n                _context2.t1 = _context2[\"catch\"](0);\n\n              case 16:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[0, 14], [3, 10]]);\n      }));\n\n      return function (_x23) {\n        return _ref2.apply(this, arguments);\n      };\n    }()));\n  });\n}\n/**\n * post a message to the other readers\n * @return {Promise<void>}\n */\n\n\nfunction postMessage(channelState, messageJson) {\n  var writePromise = writeMessage(channelState.channelName, channelState.uuid, messageJson, channelState.paths);\n  channelState.writeBlockPromise = channelState.writeBlockPromise.then( /*#__PURE__*/(0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee3() {\n    var _yield$Promise$all, msgObj, pingStr, writeToReadersPromise;\n\n    return _regenerator[\"default\"].wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return new Promise(function (res) {\n              return setTimeout(res, 0);\n            });\n\n          case 2:\n            _context3.next = 4;\n            return Promise.all([writePromise, refreshReaderClients(channelState)]);\n\n          case 4:\n            _yield$Promise$all = _context3.sent;\n            msgObj = _yield$Promise$all[0];\n            emitOverFastPath(channelState, msgObj, messageJson);\n            pingStr = '{\"t\":' + msgObj.time + ',\"u\":\"' + msgObj.uuid + '\",\"to\":\"' + msgObj.token + '\"}|';\n            writeToReadersPromise = Promise.all(Object.values(channelState.otherReaderClients).filter(function (client) {\n              return client.writable;\n            }) // client might have closed in between\n            .map(function (client) {\n              return new Promise(function (res) {\n                client.write(pingStr, res);\n              });\n            }));\n            /**\n             * clean up old messages\n             * to not waste resources on cleaning up,\n             * only if random-int matches, we clean up old messages\n             */\n\n            if (randomInt(0, 20) === 0) {\n              /* await */\n              getAllMessages(channelState.channelName, channelState.paths).then(function (allMessages) {\n                return cleanOldMessages(allMessages, channelState.options.node.ttl);\n              });\n            }\n\n            return _context3.abrupt(\"return\", writeToReadersPromise);\n\n          case 11:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  })));\n  return channelState.writeBlockPromise;\n}\n/**\n * When multiple BroadcastChannels with the same name\n * are created in a single node-process, we can access them directly and emit messages.\n * This might not happen often in production\n * but will speed up things when this module is used in unit-tests.\n */\n\n\nfunction emitOverFastPath(state, msgObj, messageJson) {\n  if (!state.options.node.useFastPath) return; // disabled\n\n  var others = OTHER_INSTANCES[state.channelName].filter(function (s) {\n    return s !== state;\n  });\n  var checkObj = {\n    time: msgObj.time,\n    senderUuid: msgObj.uuid,\n    token: msgObj.token\n  };\n  others.filter(function (otherState) {\n    return _filterMessage(checkObj, otherState);\n  }).forEach(function (otherState) {\n    otherState.messagesCallback(messageJson);\n  });\n}\n\nfunction onMessage(channelState, fn) {\n  var time = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : microSeconds();\n  channelState.messagesCallbackTime = time;\n  channelState.messagesCallback = fn;\n  handleMessagePing(channelState);\n}\n/**\n * closes the channel\n * @return {Promise}\n */\n\n\nfunction close(channelState) {\n  if (channelState.closed) return;\n  channelState.closed = true;\n  channelState.emittedMessagesIds.clear();\n  OTHER_INSTANCES[channelState.channelName] = OTHER_INSTANCES[channelState.channelName].filter(function (o) {\n    return o !== channelState;\n  });\n\n  if (channelState.removeUnload) {\n    channelState.removeUnload.remove();\n  }\n\n  return new Promise(function (res) {\n    if (channelState.socketEE) channelState.socketEE.emitter.removeAllListeners();\n    Object.values(channelState.otherReaderClients).forEach(function (client) {\n      return client.destroy();\n    });\n\n    if (channelState.infoFilePath) {\n      try {\n        fs.unlinkSync(channelState.infoFilePath);\n      } catch (err) {}\n    }\n    /**\n     * the server get closed lazy because others might still write on it\n     * and have not found out that the infoFile was deleted\n     */\n\n\n    setTimeout(function () {\n      channelState.socketEE.server.close();\n      res();\n    }, 200);\n  });\n}\n\nfunction canBeUsed() {\n  return isNode;\n}\n/**\n * on node we use a relatively height averageResponseTime,\n * because the file-io might be in use.\n * Also it is more important that the leader-election is reliable,\n * then to have a fast election.\n */\n\n\nfunction averageResponseTime() {\n  return 200;\n}\n\nfunction microSeconds() {\n  return parseInt(micro.microseconds());\n}\n\nmodule.exports = {\n  TMP_FOLDER_BASE: TMP_FOLDER_BASE,\n  cleanPipeName: cleanPipeName,\n  getPaths: getPaths,\n  ensureFoldersExist: ensureFoldersExist,\n  clearNodeFolder: clearNodeFolder,\n  socketPath: socketPath,\n  socketInfoPath: socketInfoPath,\n  createSocketInfoFile: createSocketInfoFile,\n  countChannelFolders: countChannelFolders,\n  createSocketEventEmitter: createSocketEventEmitter,\n  openClientConnection: openClientConnection,\n  writeMessage: writeMessage,\n  getReadersUuids: getReadersUuids,\n  messagePath: messagePath,\n  getAllMessages: getAllMessages,\n  getSingleMessage: getSingleMessage,\n  readMessage: readMessage,\n  cleanOldMessages: cleanOldMessages,\n  type: type,\n  create: create,\n  _filterMessage: _filterMessage,\n  handleMessagePing: handleMessagePing,\n  refreshReaderClients: refreshReaderClients,\n  postMessage: postMessage,\n  emitOverFastPath: emitOverFastPath,\n  onMessage: onMessage,\n  close: close,\n  canBeUsed: canBeUsed,\n  averageResponseTime: averageResponseTime,\n  microSeconds: microSeconds\n};"],"names":["_interopRequireDefault","require","_regenerator","_asyncToGenerator2","util","fs","os","events","net","path","micro","rimraf","sha3_224","isNode","unload","fillOptionsWithDefaults","ownUtil","randomInt","randomToken","_require","ObliviousSet","cleanPipeName","str","process","platform","startsWith","replace","mkdir","promisify","writeFile","readFile","unlink","readdir","chmod","removeDir","OTHER_INSTANCES","TMP_FOLDER_NAME","TMP_FOLDER_BASE","join","tmpdir","getPathsCache","Map","getPaths","channelName","has","channelHash","channelFolder","substring","channelPathBase","folderPathReaders","folderPathMessages","ret","channelBase","readers","messages","set","get","ENSURE_BASE_FOLDER_EXISTS_PROMISE","ensureBaseFolderExists","_ensureBaseFolderExists","apply","arguments","mark","_callee4","wrap","_callee4$","_context4","prev","next","abrupt","stop","ensureFoldersExist","_x","_x2","_ensureFoldersExist","_callee5","paths","chmodValue","_callee5$","_context5","Promise","all","clearNodeFolder","_clearNodeFolder","_callee6","_callee6$","_context6","Error","socketPath","readerUuid","socketInfoPath","createSocketInfoFile","pathToFile","JSON","stringify","time","microSeconds","then","countChannelFolders","_countChannelFolders","_callee7","folders","_callee7$","_context7","sent","length","connectionError","_x3","_connectionError","_callee8","originalError","count","addObj","text","newError","_callee8$","_context8","Object","entries","forEach","_ref4","k","v","createSocketEventEmitter","_x4","_x5","_x6","_createSocketEventEmitter","_callee11","pathToSocket","emitter","server","_callee11$","_context11","EventEmitter","createServer","stream","on","msg","emit","toString","resolve","reject","_ref5","_callee9","err","useErr","_callee9$","_context9","_x24","listen","_ref6","_callee10","res","_callee10$","_context10","_x25","_x26","openClientConnection","_x7","_x8","_openClientConnection","_callee12","client","_callee12$","_context12","Socket","rej","connect","writeMessage","messageJson","writeObject","uuid","data","token","fileName","msgPath","getReadersUuids","_x9","_x10","_getReadersUuids","_callee13","readersPath","files","_callee13$","_context13","map","file","split","filter","messagePath","_x11","_x12","_x13","_x14","_messagePath","_callee14","writerUuid","_callee14$","_context14","getAllMessages","_x15","_x16","_getAllMessages","_callee15","messagesPath","_callee15$","_context15","parseInt","senderUuid","getSingleMessage","msgObj","t","u","to","readMessage","messageObj","content","parse","cleanOldMessages","_x17","_x18","_cleanOldMessages","_callee16","messageObjects","ttl","olderThen","_callee16$","_context16","Date","now","obj","type","create","_x19","_create","_callee17","options","ensureFolderExistsPromise","state","_yield$Promise$all2","socketEE","infoFilePath","_args17","_callee17$","_context17","undefined","emittedMessagesIds","node","messagesCallbackTime","messagesCallback","writeBlockPromise","otherReaderClients","removeUnload","add","close","closed","push","refreshReaderClients","singleOnes","single","handleMessagePing","_filterMessage","_x20","_x21","_handleMessagePing","_callee18","useMessages","_callee18$","_context18","sort","msgObjA","msgObjB","channelState","otherReaders","keys","includes","_ref","_callee","_callee$","_context","destroy","t0","_x22","_ref2","_callee2","_callee2$","_context2","t1","_x23","postMessage","writePromise","_callee3","_yield$Promise$all","pingStr","writeToReadersPromise","_callee3$","_context3","setTimeout","emitOverFastPath","values","writable","write","allMessages","useFastPath","others","s","checkObj","otherState","onMessage","fn","clear","o","remove","removeAllListeners","unlinkSync","canBeUsed","averageResponseTime","microseconds","module","exports"],"mappings":"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"}