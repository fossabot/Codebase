{"version":3,"sources":["../../../../../../../../libs/movie/data-access/node_modules/react-query/lib/broadcastQueryClient-experimental/index.js"],"sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\nexports.broadcastQueryClient = broadcastQueryClient;\n\nvar _broadcastChannel = require(\"broadcast-channel\");\n\nfunction broadcastQueryClient(_ref) {\n  var queryClient = _ref.queryClient,\n      _ref$broadcastChannel = _ref.broadcastChannel,\n      broadcastChannel = _ref$broadcastChannel === void 0 ? 'react-query' : _ref$broadcastChannel;\n  var transaction = false;\n\n  var tx = function tx(cb) {\n    transaction = true;\n    cb();\n    transaction = false;\n  };\n\n  var channel = new _broadcastChannel.BroadcastChannel(broadcastChannel, {\n    webWorkerSupport: false\n  });\n  var queryCache = queryClient.getQueryCache();\n  queryClient.getQueryCache().subscribe(function (queryEvent) {\n    var _queryEvent$action;\n\n    if (transaction || !(queryEvent == null ? void 0 : queryEvent.query)) {\n      return;\n    }\n\n    var _queryEvent$query = queryEvent.query,\n        queryHash = _queryEvent$query.queryHash,\n        queryKey = _queryEvent$query.queryKey,\n        state = _queryEvent$query.state;\n\n    if (queryEvent.type === 'queryUpdated' && ((_queryEvent$action = queryEvent.action) == null ? void 0 : _queryEvent$action.type) === 'success') {\n      channel.postMessage({\n        type: 'queryUpdated',\n        queryHash: queryHash,\n        queryKey: queryKey,\n        state: state\n      });\n    }\n\n    if (queryEvent.type === 'queryRemoved') {\n      channel.postMessage({\n        type: 'queryRemoved',\n        queryHash: queryHash,\n        queryKey: queryKey\n      });\n    }\n  });\n\n  channel.onmessage = function (action) {\n    if (!(action == null ? void 0 : action.type)) {\n      return;\n    }\n\n    tx(function () {\n      var type = action.type,\n          queryHash = action.queryHash,\n          queryKey = action.queryKey,\n          state = action.state;\n\n      if (type === 'queryUpdated') {\n        var query = queryCache.get(queryHash);\n\n        if (query) {\n          query.setState(state);\n          return;\n        }\n\n        queryCache.build(queryClient, {\n          queryKey: queryKey,\n          queryHash: queryHash\n        }, state);\n      } else if (type === 'queryRemoved') {\n        var _query = queryCache.get(queryHash);\n\n        if (_query) {\n          queryCache.remove(_query);\n        }\n      }\n    });\n  };\n}"],"names":["exports","__esModule","broadcastQueryClient","_broadcastChannel","require","_ref","queryClient","_ref$broadcastChannel","broadcastChannel","transaction","tx","cb","channel","BroadcastChannel","webWorkerSupport","queryCache","getQueryCache","subscribe","queryEvent","_queryEvent$action","query","_queryEvent$query","queryHash","queryKey","state","type","action","postMessage","onmessage","get","setState","build","_query","remove"],"mappings":"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"}