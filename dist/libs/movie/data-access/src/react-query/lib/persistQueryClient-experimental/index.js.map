{"version":3,"sources":["../../../../../../../../libs/movie/data-access/node_modules/react-query/lib/persistQueryClient-experimental/index.js"],"sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\nexports.persistQueryClient = void 0;\n\nvar _logger = require(\"../core/logger\");\n\nvar _reactQuery = require(\"react-query\");\n\nfunction _await(value, then, direct) {\n  if (direct) {\n    return then ? then(value) : value;\n  }\n\n  if (!value || !value.then) {\n    value = Promise.resolve(value);\n  }\n\n  return then ? value.then(then) : value;\n}\n\nfunction _catch(body, recover) {\n  try {\n    var result = body();\n  } catch (e) {\n    return recover(e);\n  }\n\n  if (result && result.then) {\n    return result.then(void 0, recover);\n  }\n\n  return result;\n}\n\nfunction _continue(value, then) {\n  return value && value.then ? value.then(then) : then(value);\n}\n\nfunction _empty() {}\n\nfunction _invokeIgnored(body) {\n  var result = body();\n\n  if (result && result.then) {\n    return result.then(_empty);\n  }\n}\n\nfunction _async(f) {\n  return function () {\n    for (var args = [], i = 0; i < arguments.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    try {\n      return Promise.resolve(f.apply(this, args));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n}\n\nvar persistQueryClient = _async(function (_ref) {\n  var queryClient = _ref.queryClient,\n      persistor = _ref.persistor,\n      _ref$maxAge = _ref.maxAge,\n      maxAge = _ref$maxAge === void 0 ? 1000 * 60 * 60 * 24 : _ref$maxAge,\n      _ref$buster = _ref.buster,\n      buster = _ref$buster === void 0 ? '' : _ref$buster,\n      hydrateOptions = _ref.hydrateOptions,\n      dehydrateOptions = _ref.dehydrateOptions;\n  return _invokeIgnored(function () {\n    if (typeof window !== 'undefined') {\n      // Subscribe to changes\n      var saveClient = function saveClient() {\n        var persistClient = {\n          buster: buster,\n          timestamp: Date.now(),\n          clientState: (0, _reactQuery.dehydrate)(queryClient, dehydrateOptions)\n        };\n        persistor.persistClient(persistClient);\n      }; // Attempt restore\n\n\n      return _continue(_catch(function () {\n        return _await(persistor.restoreClient(), function (persistedClient) {\n          if (persistedClient) {\n            if (persistedClient.timestamp) {\n              var expired = Date.now() - persistedClient.timestamp > maxAge;\n              var busted = persistedClient.buster !== buster;\n\n              if (expired || busted) {\n                persistor.removeClient();\n              } else {\n                (0, _reactQuery.hydrate)(queryClient, persistedClient.clientState, hydrateOptions);\n              }\n            } else {\n              persistor.removeClient();\n            }\n          }\n        });\n      }, function (err) {\n        (0, _logger.getLogger)().error(err);\n        (0, _logger.getLogger)().warn('Encountered an error attempting to restore client cache from persisted location. As a precaution, the persisted cache will be discarded.');\n        persistor.removeClient();\n      }), function () {\n        // Subscribe to changes in the query cache to trigger the save\n        queryClient.getQueryCache().subscribe(saveClient);\n      });\n    }\n  });\n});\n\nexports.persistQueryClient = persistQueryClient;"],"names":["exports","__esModule","persistQueryClient","_logger","require","_reactQuery","_await","value","then","direct","Promise","resolve","_catch","body","recover","result","e","_continue","_empty","_invokeIgnored","_async","f","args","i","arguments","length","apply","reject","_ref","queryClient","persistor","_ref$maxAge","maxAge","_ref$buster","buster","hydrateOptions","dehydrateOptions","window","saveClient","persistClient","timestamp","Date","now","clientState","dehydrate","restoreClient","persistedClient","expired","busted","removeClient","hydrate","err","getLogger","error","warn","getQueryCache","subscribe"],"mappings":"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"}