{"version":3,"sources":["../../../../../../../../libs/movie/data-access/node_modules/react-query/lib/core/retryer.js"],"sourcesContent":["\"use strict\";\n\nexports.__esModule = true;\nexports.isCancelable = isCancelable;\nexports.isCancelledError = isCancelledError;\nexports.Retryer = exports.CancelledError = void 0;\n\nvar _focusManager = require(\"./focusManager\");\n\nvar _onlineManager = require(\"./onlineManager\");\n\nvar _utils = require(\"./utils\");\n\nfunction defaultRetryDelay(failureCount) {\n  return Math.min(1000 * Math.pow(2, failureCount), 30000);\n}\n\nfunction isCancelable(value) {\n  return typeof (value == null ? void 0 : value.cancel) === 'function';\n}\n\nvar CancelledError = function CancelledError(options) {\n  this.revert = options == null ? void 0 : options.revert;\n  this.silent = options == null ? void 0 : options.silent;\n};\n\nexports.CancelledError = CancelledError;\n\nfunction isCancelledError(value) {\n  return value instanceof CancelledError;\n} // CLASS\n\n\nvar Retryer = function Retryer(config) {\n  var _this = this;\n\n  var cancelRetry = false;\n  var cancelFn;\n  var continueFn;\n  var promiseResolve;\n  var promiseReject;\n  this.abort = config.abort;\n\n  this.cancel = function (cancelOptions) {\n    return cancelFn == null ? void 0 : cancelFn(cancelOptions);\n  };\n\n  this.cancelRetry = function () {\n    cancelRetry = true;\n  };\n\n  this.continueRetry = function () {\n    cancelRetry = false;\n  };\n\n  this.continue = function () {\n    return continueFn == null ? void 0 : continueFn();\n  };\n\n  this.failureCount = 0;\n  this.isPaused = false;\n  this.isResolved = false;\n  this.isTransportCancelable = false;\n  this.promise = new Promise(function (outerResolve, outerReject) {\n    promiseResolve = outerResolve;\n    promiseReject = outerReject;\n  });\n\n  var resolve = function resolve(value) {\n    if (!_this.isResolved) {\n      _this.isResolved = true;\n      config.onSuccess == null ? void 0 : config.onSuccess(value);\n      continueFn == null ? void 0 : continueFn();\n      promiseResolve(value);\n    }\n  };\n\n  var reject = function reject(value) {\n    if (!_this.isResolved) {\n      _this.isResolved = true;\n      config.onError == null ? void 0 : config.onError(value);\n      continueFn == null ? void 0 : continueFn();\n      promiseReject(value);\n    }\n  };\n\n  var pause = function pause() {\n    return new Promise(function (continueResolve) {\n      continueFn = continueResolve;\n      _this.isPaused = true;\n      config.onPause == null ? void 0 : config.onPause();\n    }).then(function () {\n      continueFn = undefined;\n      _this.isPaused = false;\n      config.onContinue == null ? void 0 : config.onContinue();\n    });\n  }; // Create loop function\n\n\n  var run = function run() {\n    // Do nothing if already resolved\n    if (_this.isResolved) {\n      return;\n    }\n\n    var promiseOrValue; // Execute query\n\n    try {\n      promiseOrValue = config.fn();\n    } catch (error) {\n      promiseOrValue = Promise.reject(error);\n    } // Create callback to cancel this fetch\n\n\n    cancelFn = function cancelFn(cancelOptions) {\n      if (!_this.isResolved) {\n        reject(new CancelledError(cancelOptions));\n        _this.abort == null ? void 0 : _this.abort(); // Cancel transport if supported\n\n        if (isCancelable(promiseOrValue)) {\n          try {\n            promiseOrValue.cancel();\n          } catch (_unused) {}\n        }\n      }\n    }; // Check if the transport layer support cancellation\n\n\n    _this.isTransportCancelable = isCancelable(promiseOrValue);\n    Promise.resolve(promiseOrValue).then(resolve).catch(function (error) {\n      var _config$retry, _config$retryDelay;\n\n      // Stop if the fetch is already resolved\n      if (_this.isResolved) {\n        return;\n      } // Do we need to retry the request?\n\n\n      var retry = (_config$retry = config.retry) != null ? _config$retry : 3;\n      var retryDelay = (_config$retryDelay = config.retryDelay) != null ? _config$retryDelay : defaultRetryDelay;\n      var delay = typeof retryDelay === 'function' ? retryDelay(_this.failureCount, error) : retryDelay;\n      var shouldRetry = retry === true || typeof retry === 'number' && _this.failureCount < retry || typeof retry === 'function' && retry(_this.failureCount, error);\n\n      if (cancelRetry || !shouldRetry) {\n        // We are done if the query does not need to be retried\n        reject(error);\n        return;\n      }\n\n      _this.failureCount++; // Notify on fail\n\n      config.onFail == null ? void 0 : config.onFail(_this.failureCount, error); // Delay\n\n      (0, _utils.sleep)(delay) // Pause if the document is not visible or when the device is offline\n      .then(function () {\n        if (!_focusManager.focusManager.isFocused() || !_onlineManager.onlineManager.isOnline()) {\n          return pause();\n        }\n      }).then(function () {\n        if (cancelRetry) {\n          reject(error);\n        } else {\n          run();\n        }\n      });\n    });\n  }; // Start loop\n\n\n  run();\n};\n\nexports.Retryer = Retryer;"],"names":["exports","__esModule","isCancelable","isCancelledError","Retryer","CancelledError","_focusManager","require","_onlineManager","_utils","defaultRetryDelay","failureCount","Math","min","pow","value","cancel","options","revert","silent","config","_this","cancelRetry","cancelFn","continueFn","promiseResolve","promiseReject","abort","cancelOptions","continueRetry","continue","isPaused","isResolved","isTransportCancelable","promise","Promise","outerResolve","outerReject","resolve","onSuccess","reject","onError","pause","continueResolve","onPause","then","undefined","onContinue","run","promiseOrValue","fn","error","_unused","catch","_config$retry","_config$retryDelay","retry","retryDelay","delay","shouldRetry","onFail","sleep","focusManager","isFocused","onlineManager","isOnline"],"mappings":"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"}