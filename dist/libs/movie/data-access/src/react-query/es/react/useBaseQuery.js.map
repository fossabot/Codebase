{"version":3,"sources":["../../../../../../../../libs/movie/data-access/node_modules/react-query/es/react/useBaseQuery.js"],"sourcesContent":["import React from 'react';\nimport { notifyManager } from '../core/notifyManager';\nimport { useQueryErrorResetBoundary } from './QueryErrorResetBoundary';\nimport { useQueryClient } from './QueryClientProvider';\nimport { shouldThrowError } from './utils';\nexport function useBaseQuery(options, Observer) {\n  var mountedRef = React.useRef(false);\n\n  var _React$useState = React.useState(0),\n      forceUpdate = _React$useState[1];\n\n  var queryClient = useQueryClient();\n  var errorResetBoundary = useQueryErrorResetBoundary();\n  var defaultedOptions = queryClient.defaultQueryObserverOptions(options); // Make sure results are optimistically set in fetching state before subscribing or updating options\n\n  defaultedOptions.optimisticResults = true; // Include callbacks in batch renders\n\n  if (defaultedOptions.onError) {\n    defaultedOptions.onError = notifyManager.batchCalls(defaultedOptions.onError);\n  }\n\n  if (defaultedOptions.onSuccess) {\n    defaultedOptions.onSuccess = notifyManager.batchCalls(defaultedOptions.onSuccess);\n  }\n\n  if (defaultedOptions.onSettled) {\n    defaultedOptions.onSettled = notifyManager.batchCalls(defaultedOptions.onSettled);\n  }\n\n  if (defaultedOptions.suspense) {\n    // Always set stale time when using suspense to prevent\n    // fetching again when directly mounting after suspending\n    if (typeof defaultedOptions.staleTime !== 'number') {\n      defaultedOptions.staleTime = 1000;\n    } // Set cache time to 1 if the option has been set to 0\n    // when using suspense to prevent infinite loop of fetches\n\n\n    if (defaultedOptions.cacheTime === 0) {\n      defaultedOptions.cacheTime = 1;\n    }\n  }\n\n  if (defaultedOptions.suspense || defaultedOptions.useErrorBoundary) {\n    // Prevent retrying failed query if the error boundary has not been reset yet\n    if (!errorResetBoundary.isReset()) {\n      defaultedOptions.retryOnMount = false;\n    }\n  }\n\n  var _React$useState2 = React.useState(function () {\n    return new Observer(queryClient, defaultedOptions);\n  }),\n      observer = _React$useState2[0];\n\n  var result = observer.getOptimisticResult(defaultedOptions);\n  React.useEffect(function () {\n    mountedRef.current = true;\n    errorResetBoundary.clearReset();\n    var unsubscribe = observer.subscribe(notifyManager.batchCalls(function () {\n      if (mountedRef.current) {\n        forceUpdate(function (x) {\n          return x + 1;\n        });\n      }\n    })); // Update result to make sure we did not miss any query updates\n    // between creating the observer and subscribing to it.\n\n    observer.updateResult();\n    return function () {\n      mountedRef.current = false;\n      unsubscribe();\n    };\n  }, [errorResetBoundary, observer]);\n  React.useEffect(function () {\n    // Do not notify on updates because of changes in the options because\n    // these changes should already be reflected in the optimistic result.\n    observer.setOptions(defaultedOptions, {\n      listeners: false\n    });\n  }, [defaultedOptions, observer]); // Handle suspense\n\n  if (defaultedOptions.suspense && result.isLoading) {\n    throw observer.fetchOptimistic(defaultedOptions).then(function (_ref) {\n      var data = _ref.data;\n      defaultedOptions.onSuccess == null ? void 0 : defaultedOptions.onSuccess(data);\n      defaultedOptions.onSettled == null ? void 0 : defaultedOptions.onSettled(data, null);\n    }).catch(function (error) {\n      errorResetBoundary.clearReset();\n      defaultedOptions.onError == null ? void 0 : defaultedOptions.onError(error);\n      defaultedOptions.onSettled == null ? void 0 : defaultedOptions.onSettled(undefined, error);\n    });\n  } // Handle error boundary\n\n\n  if (result.isError && !errorResetBoundary.isReset() && !result.isFetching && shouldThrowError(defaultedOptions.suspense, defaultedOptions.useErrorBoundary, result.error)) {\n    throw result.error;\n  } // Handle result property usage tracking\n\n\n  if (defaultedOptions.notifyOnChangeProps === 'tracked') {\n    result = observer.trackResult(result, defaultedOptions);\n  }\n\n  return result;\n}"],"names":["useBaseQuery","options","Observer","mountedRef","React","useRef","_React$useState","useState","forceUpdate","queryClient","useQueryClient","errorResetBoundary","useQueryErrorResetBoundary","defaultedOptions","defaultQueryObserverOptions","optimisticResults","onError","notifyManager","batchCalls","onSuccess","onSettled","suspense","staleTime","cacheTime","useErrorBoundary","isReset","retryOnMount","_React$useState2","observer","result","getOptimisticResult","useEffect","current","clearReset","unsubscribe","subscribe","x","updateResult","setOptions","listeners","isLoading","fetchOptimistic","then","_ref","data","catch","error","undefined","isError","isFetching","shouldThrowError","notifyOnChangeProps","trackResult"],"mappings":"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"}