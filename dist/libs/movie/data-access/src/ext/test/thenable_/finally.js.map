{"version":3,"sources":["../../../../../../../../libs/movie/data-access/node_modules/ext/test/thenable_/finally.js"],"sourcesContent":["\"use strict\";\n\nvar assert        = require(\"chai\").assert\n  , sinon         = require(\"sinon\")\n  , identity      = require(\"../../function/identity\")\n  , finallyMethod = require(\"../../thenable_/finally\");\n\nvar throwUnexpected = function () { throw new Error(\"Unexpected\"); };\n\ndescribe(\"thenable_/finally\", function () {\n\tdescribe(\"Successful on fulfilled\", function () {\n\t\tvar callback, input, result;\n\n\t\tbefore(function () {\n\t\t\tcallback = sinon.fake();\n\t\t\tinput = Promise.resolve(\"foo\");\n\t\t\tresult = finallyMethod.call(input, callback);\n\t\t\treturn result;\n\t\t});\n\n\t\tit(\"Should invoke finally callback\", function () { assert(callback.calledOnce); });\n\n\t\tit(\"Return promise should fulfill with original result\", function () {\n\t\t\treturn Promise.all([input, result]).then(function (results) {\n\t\t\t\tassert.equal(results[0], results[1]);\n\t\t\t});\n\t\t});\n\t});\n\n\tdescribe(\"Successful on rejected\", function () {\n\t\tvar callback, input, result;\n\n\t\tbefore(function () {\n\t\t\tvar inputError = new Error(\"Rejected\");\n\t\t\tcallback = sinon.fake();\n\t\t\tinput = Promise.reject(inputError);\n\t\t\tresult = finallyMethod.call(input, callback);\n\t\t\treturn result[\"catch\"](function (error) { if (error !== inputError) throw error; });\n\t\t});\n\n\t\tit(\"Should invoke finally callback\", function () { assert(callback.calledOnce); });\n\n\t\tit(\"Return promise should fulfill with original result\", function () {\n\t\t\treturn Promise.all([input[\"catch\"](identity), result[\"catch\"](identity)]).then(\n\t\t\t\tfunction (results) { assert.equal(results[0], results[1]); }\n\t\t\t);\n\t\t});\n\t});\n\n\tdescribe(\"Failed on fulfilled\", function () {\n\t\tvar callback, result, finallyError;\n\n\t\tbefore(function () {\n\t\t\tfinallyError = new Error(\"Finally Rejected\");\n\t\t\tcallback = sinon.fake[\"throws\"](finallyError);\n\t\t\tvar input = Promise.resolve(\"foo\");\n\t\t\tresult = finallyMethod.call(input, callback);\n\t\t\treturn result[\"catch\"](function (error) { if (error !== finallyError) throw error; });\n\t\t});\n\n\t\tit(\"Should invoke finally callback\", function () { assert(callback.calledOnce); });\n\n\t\tit(\"Return promise should be rejected with finally error\", function () {\n\t\t\treturn result.then(throwUnexpected, function (error) {\n\t\t\t\tassert.equal(finallyError, error);\n\t\t\t});\n\t\t});\n\t});\n\n\tdescribe(\"Failed on rejected\", function () {\n\t\tvar callback, result, finallyError;\n\n\t\tbefore(function () {\n\t\t\tfinallyError = new Error(\"Finally Rejected\");\n\t\t\tcallback = sinon.fake[\"throws\"](finallyError);\n\t\t\tvar input = Promise.reject(new Error(\"Rejected\"));\n\t\t\tresult = finallyMethod.call(input, callback);\n\t\t\treturn result[\"catch\"](function (error) { if (error !== finallyError) throw error; });\n\t\t});\n\n\t\tit(\"Should invoke finally callback\", function () { assert(callback.calledOnce); });\n\n\t\tit(\"Return promise should be rejected with finally error\", function () {\n\t\t\treturn result.then(throwUnexpected, function (error) {\n\t\t\t\tassert.equal(finallyError, error);\n\t\t\t});\n\t\t});\n\t});\n});\n"],"names":["assert","require","sinon","identity","finallyMethod","throwUnexpected","Error","describe","callback","input","result","before","fake","Promise","resolve","call","it","calledOnce","all","then","results","equal","inputError","reject","error","finallyError"],"mappings":"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"}