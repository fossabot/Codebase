{"version":3,"sources":["../../../../../../../../../libs/movie/data-access/node_modules/@supabase/realtime-js/dist/module/RealtimeClient.js"],"sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { VSN, CHANNEL_EVENTS, TRANSPORTS, SOCKET_STATES, DEFAULT_TIMEOUT, WS_CLOSE_NORMAL, DEFAULT_HEADERS, } from './lib/constants';\nimport Timer from './lib/timer';\nimport RealtimeSubscription from './RealtimeSubscription';\nimport { w3cwebsocket as WebSocket } from 'websocket';\nimport Serializer from './lib/serializer';\nconst noop = () => { };\nexport default class RealtimeClient {\n    /**\n     * Initializes the Socket\n     *\n     * @param endPoint The string WebSocket endpoint, ie, \"ws://example.com/socket\", \"wss://example.com\", \"/socket\" (inherited host & protocol)\n     * @param options.transport The Websocket Transport, for example WebSocket.\n     * @param options.timeout The default timeout in milliseconds to trigger push timeouts.\n     * @param options.params The optional params to pass when connecting.\n     * @param options.headers The optional headers to pass when connecting.\n     * @param options.heartbeatIntervalMs The millisec interval to send a heartbeat message.\n     * @param options.logger The optional function for specialized logging, ie: logger: (kind, msg, data) => { console.log(`${kind}: ${msg}`, data) }\n     * @param options.encode The function to encode outgoing messages. Defaults to JSON: (payload, callback) => callback(JSON.stringify(payload))\n     * @param options.decode The function to decode incoming messages. Defaults to Serializer's decode.\n     * @param options.longpollerTimeout The maximum timeout of a long poll AJAX request. Defaults to 20s (double the server long poll timer).\n     * @param options.reconnectAfterMs he optional function that returns the millsec reconnect interval. Defaults to stepped backoff off.\n     */\n    constructor(endPoint, options) {\n        this.accessToken = null;\n        this.channels = [];\n        this.endPoint = '';\n        this.headers = DEFAULT_HEADERS;\n        this.params = {};\n        this.timeout = DEFAULT_TIMEOUT;\n        this.transport = WebSocket;\n        this.heartbeatIntervalMs = 30000;\n        this.longpollerTimeout = 20000;\n        this.heartbeatTimer = undefined;\n        this.pendingHeartbeatRef = null;\n        this.ref = 0;\n        this.logger = noop;\n        this.conn = null;\n        this.sendBuffer = [];\n        this.serializer = new Serializer();\n        this.stateChangeCallbacks = {\n            open: [],\n            close: [],\n            error: [],\n            message: [],\n        };\n        this.endPoint = `${endPoint}/${TRANSPORTS.websocket}`;\n        if (options === null || options === void 0 ? void 0 : options.params)\n            this.params = options.params;\n        if (options === null || options === void 0 ? void 0 : options.headers)\n            this.headers = Object.assign(Object.assign({}, this.headers), options.headers);\n        if (options === null || options === void 0 ? void 0 : options.timeout)\n            this.timeout = options.timeout;\n        if (options === null || options === void 0 ? void 0 : options.logger)\n            this.logger = options.logger;\n        if (options === null || options === void 0 ? void 0 : options.transport)\n            this.transport = options.transport;\n        if (options === null || options === void 0 ? void 0 : options.heartbeatIntervalMs)\n            this.heartbeatIntervalMs = options.heartbeatIntervalMs;\n        if (options === null || options === void 0 ? void 0 : options.longpollerTimeout)\n            this.longpollerTimeout = options.longpollerTimeout;\n        this.reconnectAfterMs = (options === null || options === void 0 ? void 0 : options.reconnectAfterMs)\n            ? options.reconnectAfterMs\n            : (tries) => {\n                return [1000, 2000, 5000, 10000][tries - 1] || 10000;\n            };\n        this.encode = (options === null || options === void 0 ? void 0 : options.encode)\n            ? options.encode\n            : (payload, callback) => {\n                return callback(JSON.stringify(payload));\n            };\n        this.decode = (options === null || options === void 0 ? void 0 : options.decode)\n            ? options.decode\n            : this.serializer.decode.bind(this.serializer);\n        this.reconnectTimer = new Timer(() => __awaiter(this, void 0, void 0, function* () {\n            yield this.disconnect();\n            this.connect();\n        }), this.reconnectAfterMs);\n    }\n    /**\n     * Connects the socket.\n     */\n    connect() {\n        if (this.conn) {\n            return;\n        }\n        this.conn = new this.transport(this.endPointURL(), [], null, this.headers);\n        if (this.conn) {\n            // this.conn.timeout = this.longpollerTimeout // TYPE ERROR\n            this.conn.binaryType = 'arraybuffer';\n            this.conn.onopen = () => this._onConnOpen();\n            this.conn.onerror = (error) => this._onConnError(error);\n            this.conn.onmessage = (event) => this.onConnMessage(event);\n            this.conn.onclose = (event) => this._onConnClose(event);\n        }\n    }\n    /**\n     * Disconnects the socket.\n     *\n     * @param code A numeric status code to send on disconnect.\n     * @param reason A custom reason for the disconnect.\n     */\n    disconnect(code, reason) {\n        return new Promise((resolve, _reject) => {\n            try {\n                if (this.conn) {\n                    this.conn.onclose = function () { }; // noop\n                    if (code) {\n                        this.conn.close(code, reason || '');\n                    }\n                    else {\n                        this.conn.close();\n                    }\n                    this.conn = null;\n                    // remove open handles\n                    this.heartbeatTimer && clearInterval(this.heartbeatTimer);\n                    this.reconnectTimer.reset();\n                }\n                resolve({ error: null, data: true });\n            }\n            catch (error) {\n                resolve({ error: error, data: false });\n            }\n        });\n    }\n    /**\n     * Logs the message. Override `this.logger` for specialized logging.\n     */\n    log(kind, msg, data) {\n        this.logger(kind, msg, data);\n    }\n    /**\n     * Registers a callback for connection state change event.\n     * @param callback A function to be called when the event occurs.\n     *\n     * @example\n     *    socket.onOpen(() => console.log(\"Socket opened.\"))\n     */\n    onOpen(callback) {\n        this.stateChangeCallbacks.open.push(callback);\n    }\n    /**\n     * Registers a callbacks for connection state change events.\n     * @param callback A function to be called when the event occurs.\n     *\n     * @example\n     *    socket.onOpen(() => console.log(\"Socket closed.\"))\n     */\n    onClose(callback) {\n        this.stateChangeCallbacks.close.push(callback);\n    }\n    /**\n     * Registers a callback for connection state change events.\n     * @param callback A function to be called when the event occurs.\n     *\n     * @example\n     *    socket.onOpen((error) => console.log(\"An error occurred\"))\n     */\n    onError(callback) {\n        this.stateChangeCallbacks.error.push(callback);\n    }\n    /**\n     * Calls a function any time a message is received.\n     * @param callback A function to be called when the event occurs.\n     *\n     * @example\n     *    socket.onMessage((message) => console.log(message))\n     */\n    onMessage(callback) {\n        this.stateChangeCallbacks.message.push(callback);\n    }\n    /**\n     * Returns the current state of the socket.\n     */\n    connectionState() {\n        switch (this.conn && this.conn.readyState) {\n            case SOCKET_STATES.connecting:\n                return 'connecting';\n            case SOCKET_STATES.open:\n                return 'open';\n            case SOCKET_STATES.closing:\n                return 'closing';\n            default:\n                return 'closed';\n        }\n    }\n    /**\n     * Retuns `true` is the connection is open.\n     */\n    isConnected() {\n        return this.connectionState() === 'open';\n    }\n    /**\n     * Removes a subscription from the socket.\n     *\n     * @param channel An open subscription.\n     */\n    remove(channel) {\n        this.channels = this.channels.filter((c) => c.joinRef() !== channel.joinRef());\n    }\n    channel(topic, chanParams = {}) {\n        let chan = new RealtimeSubscription(topic, chanParams, this);\n        this.channels.push(chan);\n        return chan;\n    }\n    push(data) {\n        let { topic, event, payload, ref } = data;\n        let callback = () => {\n            this.encode(data, (result) => {\n                var _a;\n                (_a = this.conn) === null || _a === void 0 ? void 0 : _a.send(result);\n            });\n        };\n        this.log('push', `${topic} ${event} (${ref})`, payload);\n        if (this.isConnected()) {\n            callback();\n        }\n        else {\n            this.sendBuffer.push(callback);\n        }\n    }\n    onConnMessage(rawMessage) {\n        this.decode(rawMessage.data, (msg) => {\n            let { topic, event, payload, ref } = msg;\n            if (ref && ref === this.pendingHeartbeatRef) {\n                this.pendingHeartbeatRef = null;\n            }\n            else if (event === (payload === null || payload === void 0 ? void 0 : payload.type)) {\n                this._resetHeartbeat();\n            }\n            this.log('receive', `${payload.status || ''} ${topic} ${event} ${(ref && '(' + ref + ')') || ''}`, payload);\n            this.channels\n                .filter((channel) => channel.isMember(topic))\n                .forEach((channel) => channel.trigger(event, payload, ref));\n            this.stateChangeCallbacks.message.forEach((callback) => callback(msg));\n        });\n    }\n    /**\n     * Returns the URL of the websocket.\n     */\n    endPointURL() {\n        return this._appendParams(this.endPoint, Object.assign({}, this.params, { vsn: VSN }));\n    }\n    /**\n     * Return the next message ref, accounting for overflows\n     */\n    makeRef() {\n        let newRef = this.ref + 1;\n        if (newRef === this.ref) {\n            this.ref = 0;\n        }\n        else {\n            this.ref = newRef;\n        }\n        return this.ref.toString();\n    }\n    /**\n     * Sets the JWT access token used for channel subscription authorization and Realtime RLS.\n     *\n     * @param token A JWT string.\n     */\n    setAuth(token) {\n        this.accessToken = token;\n        try {\n            this.channels.forEach((channel) => {\n                token && channel.updateJoinPayload({ user_token: token });\n                if (channel.joinedOnce && channel.isJoined()) {\n                    channel.push(CHANNEL_EVENTS.access_token, { access_token: token });\n                }\n            });\n        }\n        catch (error) {\n            console.log('setAuth error', error);\n        }\n    }\n    leaveOpenTopic(topic) {\n        let dupChannel = this.channels.find((c) => c.topic === topic && (c.isJoined() || c.isJoining()));\n        if (dupChannel) {\n            this.log('transport', `leaving duplicate topic \"${topic}\"`);\n            dupChannel.unsubscribe();\n        }\n    }\n    _onConnOpen() {\n        this.log('transport', `connected to ${this.endPointURL()}`);\n        this._flushSendBuffer();\n        this.reconnectTimer.reset();\n        this._resetHeartbeat();\n        this.stateChangeCallbacks.open.forEach((callback) => callback());\n    }\n    _onConnClose(event) {\n        this.log('transport', 'close', event);\n        this._triggerChanError();\n        this.heartbeatTimer && clearInterval(this.heartbeatTimer);\n        this.reconnectTimer.scheduleTimeout();\n        this.stateChangeCallbacks.close.forEach((callback) => callback(event));\n    }\n    _onConnError(error) {\n        this.log('transport', error.message);\n        this._triggerChanError();\n        this.stateChangeCallbacks.error.forEach((callback) => callback(error));\n    }\n    _triggerChanError() {\n        this.channels.forEach((channel) => channel.trigger(CHANNEL_EVENTS.error));\n    }\n    _appendParams(url, params) {\n        if (Object.keys(params).length === 0) {\n            return url;\n        }\n        const prefix = url.match(/\\?/) ? '&' : '?';\n        const query = new URLSearchParams(params);\n        return `${url}${prefix}${query}`;\n    }\n    _flushSendBuffer() {\n        if (this.isConnected() && this.sendBuffer.length > 0) {\n            this.sendBuffer.forEach((callback) => callback());\n            this.sendBuffer = [];\n        }\n    }\n    _resetHeartbeat() {\n        this.pendingHeartbeatRef = null;\n        this.heartbeatTimer && clearInterval(this.heartbeatTimer);\n        this.heartbeatTimer = setInterval(() => this._sendHeartbeat(), this.heartbeatIntervalMs);\n    }\n    _sendHeartbeat() {\n        var _a;\n        if (!this.isConnected()) {\n            return;\n        }\n        if (this.pendingHeartbeatRef) {\n            this.pendingHeartbeatRef = null;\n            this.log('transport', 'heartbeat timeout. Attempting to re-establish connection');\n            (_a = this.conn) === null || _a === void 0 ? void 0 : _a.close(WS_CLOSE_NORMAL, 'hearbeat timeout');\n            return;\n        }\n        this.pendingHeartbeatRef = this.makeRef();\n        this.push({\n            topic: 'phoenix',\n            event: 'heartbeat',\n            payload: {},\n            ref: this.pendingHeartbeatRef,\n        });\n        this.setAuth(this.accessToken);\n    }\n}\n//# sourceMappingURL=RealtimeClient.js.map"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","noop","RealtimeClient","connect","conn","transport","endPointURL","headers","binaryType","onopen","_onConnOpen","onerror","error","_onConnError","onmessage","event","onConnMessage","onclose","_onConnClose","disconnect","code","reason","_reject","close","heartbeatTimer","clearInterval","reconnectTimer","reset","data","log","kind","msg","logger","onOpen","callback","stateChangeCallbacks","open","push","onClose","onError","onMessage","message","connectionState","readyState","SOCKET_STATES","connecting","closing","isConnected","remove","channel","channels","filter","c","joinRef","topic","chanParams","chan","RealtimeSubscription","payload","ref","encode","_a","send","sendBuffer","rawMessage","decode","pendingHeartbeatRef","type","_resetHeartbeat","status","isMember","forEach","trigger","_appendParams","endPoint","Object","assign","params","vsn","VSN","makeRef","newRef","toString","setAuth","token","accessToken","updateJoinPayload","user_token","joinedOnce","isJoined","CHANNEL_EVENTS","access_token","console","leaveOpenTopic","dupChannel","find","isJoining","unsubscribe","_flushSendBuffer","_triggerChanError","scheduleTimeout","url","keys","length","prefix","match","query","URLSearchParams","setInterval","_sendHeartbeat","heartbeatIntervalMs","WS_CLOSE_NORMAL","options","DEFAULT_HEADERS","timeout","DEFAULT_TIMEOUT","WebSocket","longpollerTimeout","undefined","serializer","Serializer","TRANSPORTS","websocket","reconnectAfterMs","tries","JSON","stringify","bind","Timer"],"mappings":"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"}