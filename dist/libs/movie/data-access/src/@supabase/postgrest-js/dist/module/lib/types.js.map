{"version":3,"sources":["../../../../../../../../../../libs/movie/data-access/node_modules/@supabase/postgrest-js/dist/module/lib/types.js"],"sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport crossFetch from 'cross-fetch';\nexport class PostgrestBuilder {\n    constructor(builder) {\n        this.shouldThrowOnError = false;\n        Object.assign(this, builder);\n        this.fetch = builder.fetch || crossFetch;\n    }\n    /**\n     * If there's an error with the query, throwOnError will reject the promise by\n     * throwing the error instead of returning it as part of a successful response.\n     *\n     * {@link https://github.com/supabase/supabase-js/issues/92}\n     */\n    throwOnError() {\n        this.shouldThrowOnError = true;\n        return this;\n    }\n    then(onfulfilled, onrejected) {\n        // https://postgrest.org/en/stable/api.html#switching-schemas\n        if (typeof this.schema === 'undefined') {\n            // skip\n        }\n        else if (['GET', 'HEAD'].includes(this.method)) {\n            this.headers['Accept-Profile'] = this.schema;\n        }\n        else {\n            this.headers['Content-Profile'] = this.schema;\n        }\n        if (this.method !== 'GET' && this.method !== 'HEAD') {\n            this.headers['Content-Type'] = 'application/json';\n        }\n        let res = this.fetch(this.url.toString(), {\n            method: this.method,\n            headers: this.headers,\n            body: JSON.stringify(this.body),\n            signal: this.signal,\n        }).then((res) => __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c;\n            let error = null;\n            let data = null;\n            let count = null;\n            if (res.ok) {\n                const isReturnMinimal = (_a = this.headers['Prefer']) === null || _a === void 0 ? void 0 : _a.split(',').includes('return=minimal');\n                if (this.method !== 'HEAD' && !isReturnMinimal) {\n                    const text = yield res.text();\n                    if (!text) {\n                        // discard `text`\n                    }\n                    else if (this.headers['Accept'] === 'text/csv') {\n                        data = text;\n                    }\n                    else {\n                        data = JSON.parse(text);\n                    }\n                }\n                const countHeader = (_b = this.headers['Prefer']) === null || _b === void 0 ? void 0 : _b.match(/count=(exact|planned|estimated)/);\n                const contentRange = (_c = res.headers.get('content-range')) === null || _c === void 0 ? void 0 : _c.split('/');\n                if (countHeader && contentRange && contentRange.length > 1) {\n                    count = parseInt(contentRange[1]);\n                }\n            }\n            else {\n                const body = yield res.text();\n                try {\n                    error = JSON.parse(body);\n                }\n                catch (_d) {\n                    error = {\n                        message: body,\n                    };\n                }\n                if (error && this.shouldThrowOnError) {\n                    throw error;\n                }\n            }\n            const postgrestResponse = {\n                error,\n                data,\n                count,\n                status: res.status,\n                statusText: res.statusText,\n                body: data,\n            };\n            return postgrestResponse;\n        }));\n        if (!this.shouldThrowOnError) {\n            res = res.catch((fetchError) => ({\n                error: {\n                    message: `FetchError: ${fetchError.message}`,\n                    details: '',\n                    hint: '',\n                    code: fetchError.code || '',\n                },\n                data: null,\n                body: null,\n                count: null,\n                status: 400,\n                statusText: 'Bad Request',\n            }));\n        }\n        return res.then(onfulfilled, onrejected);\n    }\n}\n//# sourceMappingURL=types.js.map"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","PostgrestBuilder","throwOnError","shouldThrowOnError","onfulfilled","onrejected","schema","includes","method","headers","res","fetch","url","toString","body","JSON","stringify","signal","_a","_b","_c","error","data","count","ok","isReturnMinimal","split","text","parse","countHeader","match","contentRange","get","length","parseInt","_d","message","postgrestResponse","status","statusText","catch","fetchError","details","hint","code","builder","Object","assign","crossFetch"],"mappings":"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"}