{"version":3,"sources":["../../../../../../../../../libs/movie/data-access/node_modules/@supabase/gotrue-js/src/lib/cookies.ts"],"sourcesContent":["type Cookie = {\n  name: string\n  value: string\n  maxAge: number\n  domain?: string\n  path?: string\n  sameSite?: string\n}\n\n/**\n * Serialize data into a cookie header.\n */\nfunction serialize(\n  name: string,\n  val: string,\n  options: {\n    maxAge: number\n    domain: string\n    path: string\n    expires: Date\n    httpOnly: boolean\n    secure: boolean\n    sameSite: string\n  }\n) {\n  const opt = options || {}\n  const enc = encodeURIComponent\n  /* eslint-disable-next-line no-control-regex */\n  const fieldContentRegExp = /^[\\u0009\\u0020-\\u007e\\u0080-\\u00ff]+$/\n\n  if (typeof enc !== 'function') {\n    throw new TypeError('option encode is invalid')\n  }\n\n  if (!fieldContentRegExp.test(name)) {\n    throw new TypeError('argument name is invalid')\n  }\n\n  const value = enc(val)\n\n  if (value && !fieldContentRegExp.test(value)) {\n    throw new TypeError('argument val is invalid')\n  }\n\n  let str = name + '=' + value\n\n  if (null != opt.maxAge) {\n    const maxAge = opt.maxAge - 0\n\n    if (isNaN(maxAge) || !isFinite(maxAge)) {\n      throw new TypeError('option maxAge is invalid')\n    }\n\n    str += '; Max-Age=' + Math.floor(maxAge)\n  }\n\n  if (opt.domain) {\n    if (!fieldContentRegExp.test(opt.domain)) {\n      throw new TypeError('option domain is invalid')\n    }\n\n    str += '; Domain=' + opt.domain\n  }\n\n  if (opt.path) {\n    if (!fieldContentRegExp.test(opt.path)) {\n      throw new TypeError('option path is invalid')\n    }\n\n    str += '; Path=' + opt.path\n  }\n\n  if (opt.expires) {\n    if (typeof opt.expires.toUTCString !== 'function') {\n      throw new TypeError('option expires is invalid')\n    }\n\n    str += '; Expires=' + opt.expires.toUTCString()\n  }\n\n  if (opt.httpOnly) {\n    str += '; HttpOnly'\n  }\n\n  if (opt.secure) {\n    str += '; Secure'\n  }\n\n  if (opt.sameSite) {\n    const sameSite = typeof opt.sameSite === 'string' ? opt.sameSite.toLowerCase() : opt.sameSite\n\n    switch (sameSite) {\n      case 'lax':\n        str += '; SameSite=Lax'\n        break\n      case 'strict':\n        str += '; SameSite=Strict'\n        break\n      case 'none':\n        str += '; SameSite=None'\n        break\n      default:\n        throw new TypeError('option sameSite is invalid')\n    }\n  }\n\n  return str\n}\n\n/**\n * Based on the environment and the request we know if a secure cookie can be set.\n */\nfunction isSecureEnvironment(req: any) {\n  if (!req || !req.headers || !req.headers.host) {\n    throw new Error('The \"host\" request header is not available')\n  }\n\n  const host =\n    (req.headers.host.indexOf(':') > -1 && req.headers.host.split(':')[0]) || req.headers.host\n  if (['localhost', '127.0.0.1'].indexOf(host) > -1 || host.endsWith('.local')) {\n    return false\n  }\n\n  return true\n}\n\n/**\n * Serialize a cookie to a string.\n */\nfunction serializeCookie(cookie: Cookie, secure: boolean) {\n  return serialize(cookie.name, cookie.value, {\n    maxAge: cookie.maxAge,\n    expires: new Date(Date.now() + cookie.maxAge * 1000),\n    httpOnly: true,\n    secure,\n    path: cookie.path ?? '/',\n    domain: cookie.domain ?? '',\n    sameSite: cookie.sameSite ?? 'lax',\n  })\n}\n\n/**\n * Get Cookie Header strings.\n */\nexport function getCookieString(req: any, res: any, cookies: Array<Cookie>): string[] {\n  const strCookies = cookies.map((c) => serializeCookie(c, isSecureEnvironment(req)))\n  const previousCookies = res.getHeader('Set-Cookie')\n  if (previousCookies) {\n    if (previousCookies instanceof Array) {\n      Array.prototype.push.apply(strCookies, previousCookies)\n    } else if (typeof previousCookies === 'string') {\n      strCookies.push(previousCookies)\n    }\n  }\n  return strCookies\n}\n\n/**\n * Set one or more cookies.\n */\nexport function setCookies(req: any, res: any, cookies: Array<Cookie>) {\n  res.setHeader('Set-Cookie', getCookieString(req, res, cookies))\n}\n\n/**\n * Set one or more cookies.\n */\nexport function setCookie(req: any, res: any, cookie: Cookie) {\n  setCookies(req, res, [cookie])\n}\n\nexport function deleteCookie(req: any, res: any, name: string) {\n  setCookie(req, res, {\n    name,\n    value: '',\n    maxAge: -1,\n  })\n}\n"],"names":["getCookieString","setCookies","setCookie","deleteCookie","serialize","name","val","options","opt","enc","encodeURIComponent","fieldContentRegExp","TypeError","test","value","str","maxAge","isNaN","isFinite","Math","floor","domain","path","expires","toUTCString","httpOnly","secure","sameSite","toLowerCase","isSecureEnvironment","req","headers","host","Error","indexOf","split","endsWith","serializeCookie","cookie","Date","now","res","cookies","strCookies","map","c","previousCookies","getHeader","Array","prototype","push","apply","setHeader"],"mappings":"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"}